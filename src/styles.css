:root {
  --bg: #061018;
  --panel: rgba(8, 22, 30, 0.72);
  --panel2: rgba(7, 18, 26, 0.88);
  --ink: #d8f6ff;
  --muted: rgba(216, 246, 255, 0.72);
  --blue: #67d3ff;
  --blue2: #2aa6d8;
  --gold: #ffd77a;
  --red: #d0243d;
  --green: #1f8f54;
  --pine: #0e2b1d;
  --danger: #ff5f5f;
  --grid: rgba(103, 211, 255, 0.18);
  --shadow: rgba(0, 0, 0, 0.45);
  --radius: 16px;
  --radius2: 12px;
  --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New",
    monospace;
  --serif: ui-serif, Georgia, Cambria, "Times New Roman", Times, serif;
  --hand: "Bradley Hand", "Segoe Print", "Segoe Script", "Snell Roundhand", "Apple Chancery", "Noteworthy", cursive;
  --drama: 0;
}

* {
  box-sizing: border-box;
}

html,
body {
  height: 100%;
}

html {
  -webkit-text-size-adjust: 100%;
}

body {
  margin: 0;
  color: var(--ink);
  background:
    /* Blueprint paper base (richer, more “printed sheet”) */
    radial-gradient(1200px 900px at 50% 10%, rgba(255, 255, 255, 0.06), transparent 60%),
    radial-gradient(900px 700px at 80% 28%, rgba(255, 215, 122, 0.10), transparent 58%),
    radial-gradient(900px 700px at 18% 22%, rgba(208, 36, 61, 0.09), transparent 58%),
    radial-gradient(900px 700px at 78% 16%, rgba(31, 143, 84, 0.08), transparent 58%),
    radial-gradient(1200px 900px at 20% 10%, rgba(103, 211, 255, 0.18), transparent 62%),
    linear-gradient(180deg, #082232, #05131b);
  font-family: var(--mono);
  overflow-x: hidden;
  overscroll-behavior: none;
}

.srOnly {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Mobile touch polish */
button,
a,
input {
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

button {
  touch-action: manipulation;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
}

/* Blueprint vibe boost */
body::before {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  background:
    /* Subtle paper grain (no images, all gradients) */
    radial-gradient(2px 2px at 22% 18%, rgba(255, 255, 255, 0.08), transparent 60%),
    radial-gradient(2px 2px at 72% 46%, rgba(255, 255, 255, 0.07), transparent 60%),
    radial-gradient(2px 2px at 44% 78%, rgba(255, 255, 255, 0.06), transparent 60%),
    radial-gradient(2px 2px at 62% 64%, rgba(255, 255, 255, 0.05), transparent 60%),
    /* Blueprint grid */
    repeating-linear-gradient(0deg, transparent, transparent 18px, rgba(103, 211, 255, 0.055) 19px, transparent 20px),
    repeating-linear-gradient(90deg, transparent, transparent 18px, rgba(103, 211, 255, 0.055) 19px, transparent 20px);
  opacity: 0.42;
  mix-blend-mode: screen;
}

/* Blueprint “sheet” details: margins, fold lines, edge vignette */
body::after {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  background:
    /* inner frame */
    linear-gradient(90deg, rgba(232, 251, 255, 0.10), rgba(232, 251, 255, 0.10)) 14px 14px / calc(100% - 28px) 1px no-repeat,
    linear-gradient(90deg, rgba(232, 251, 255, 0.10), rgba(232, 251, 255, 0.10)) 14px calc(100% - 14px) / calc(100% - 28px) 1px no-repeat,
    linear-gradient(rgba(232, 251, 255, 0.10), rgba(232, 251, 255, 0.10)) 14px 14px / 1px calc(100% - 28px) no-repeat,
    linear-gradient(rgba(232, 251, 255, 0.10), rgba(232, 251, 255, 0.10)) calc(100% - 14px) 14px / 1px calc(100% - 28px) no-repeat,
    /* fold creases */
    linear-gradient(135deg, rgba(255, 255, 255, 0.05), transparent 35%, rgba(0, 0, 0, 0.10) 52%, transparent 70%) 0 0 / 100% 100%,
    linear-gradient(45deg, rgba(255, 255, 255, 0.04), transparent 34%, rgba(0, 0, 0, 0.09) 52%, transparent 70%) 0 0 / 100% 100%,
    /* vignette / edge wear */
    radial-gradient(1200px 900px at 50% 50%, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.52));
  opacity: 0.55;
  mix-blend-mode: multiply;
}

body[data-stage="note"]::after {
  opacity: 0.5;
}

body[data-stage="terminal"]::after {
  opacity: 0.62;
}

/* Festive overlay: subtle garland + lights (mobile-safe, low clutter) */
.festiveOverlay {
  position: fixed;
  inset: 0;
  z-index: 2;
  pointer-events: none;
  opacity: 0.55;
  mix-blend-mode: screen;
  filter: saturate(1.05);
}

body[data-stage="note"] .festiveOverlay {
  opacity: 0.85;
}

body[data-stage="present"] .festiveOverlay {
  opacity: 0.72;
}

body[data-stage="terminal"] .festiveOverlay {
  opacity: 0.28;
}

body[data-stage="final"] .festiveOverlay {
  opacity: 0.5;
}

.festiveOverlay__svg {
  width: 100%;
  height: 100%;
  display: block;
  opacity: 0.95;
}

.festiveWire {
  stroke: rgba(255, 215, 122, 0.28);
  stroke-width: 3;
  stroke-linecap: round;
  filter: drop-shadow(0 8px 14px rgba(0, 0, 0, 0.22));
}

.festiveGarland {
  fill: rgba(31, 143, 84, 0.16);
  stroke: rgba(31, 255, 140, 0.18);
  stroke-width: 2;
  filter: drop-shadow(0 10px 22px rgba(0, 0, 0, 0.22));
}

.festiveBulb {
  opacity: 0.86;
  filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.25));
  animation: bulbTwinkle 2.8s ease-in-out infinite;
}
.festiveBulb--r {
  fill: rgba(255, 95, 95, 0.72);
}
.festiveBulb--g {
  fill: rgba(31, 255, 140, 0.62);
}
.festiveBulb--y {
  fill: rgba(255, 215, 122, 0.75);
}
.festiveBulb--b {
  fill: rgba(103, 211, 255, 0.65);
}

.festiveBulb:nth-child(2n) {
  animation-delay: 0.2s;
}
.festiveBulb:nth-child(3n) {
  animation-delay: 0.45s;
}
.festiveBulb:nth-child(5n) {
  animation-delay: 0.75s;
}

@keyframes bulbTwinkle {
  0% {
    transform: translateY(0px);
    opacity: 0.68;
    filter: drop-shadow(0 10px 18px rgba(0, 0, 0, 0.2));
  }
  50% {
    transform: translateY(-1px);
    opacity: 0.98;
    filter: drop-shadow(0 12px 24px rgba(0, 0, 0, 0.26));
  }
  100% {
    transform: translateY(0px);
    opacity: 0.72;
    filter: drop-shadow(0 10px 18px rgba(0, 0, 0, 0.2));
  }
}

.festiveLeaf {
  fill: rgba(31, 143, 84, 0.18);
  stroke: rgba(31, 255, 140, 0.16);
  stroke-width: 2;
}
.festiveBerry {
  fill: rgba(208, 36, 61, 0.72);
  stroke: rgba(255, 215, 122, 0.16);
  stroke-width: 2;
  filter: drop-shadow(0 10px 18px rgba(0, 0, 0, 0.18));
}

body.reduce-motion .festiveBulb {
  animation: none;
}

/* Ambient overlays */
.crt {
  position: fixed;
  inset: 0;
  pointer-events: none;
  background:
    radial-gradient(1200px 900px at 50% 50%, rgba(0, 0, 0, 0) 40%, rgba(0, 0, 0, 0.42) 100%);
  mix-blend-mode: multiply;
  opacity: 0.72;
  z-index: 3;
}

.scanlines {
  position: fixed;
  inset: 0;
  pointer-events: none;
  background: linear-gradient(
    to bottom,
    rgba(255, 255, 255, 0.045) 0px,
    rgba(255, 255, 255, 0.015) 1px,
    rgba(0, 0, 0, 0) 3px
  );
  background-size: 100% 4px;
  opacity: calc(0.12 + (var(--drama) * 0.14));
  z-index: 4;
}

#snow {
  position: fixed;
  inset: 0;
  z-index: 1;
  pointer-events: none;
}

#debris {
  position: fixed;
  inset: 0;
  z-index: 2;
  pointer-events: none;
  mix-blend-mode: screen;
  opacity: calc(0.22 + (var(--drama) * 0.36));
}

body[data-stage="note"] #debris {
  opacity: 0.08;
}

body[data-stage="present"] #debris {
  opacity: 0.14;
}

body[data-stage="final"] #debris {
  opacity: 0.12;
}

/* Extra winter sparkles (subtle) */
.snowSparkle {
  position: fixed;
  inset: 0;
  z-index: 2;
  pointer-events: none;
  background:
    radial-gradient(4px 4px at 12% 18%, rgba(255, 215, 122, 0.16), transparent 60%),
    radial-gradient(3px 3px at 82% 24%, rgba(103, 211, 255, 0.16), transparent 60%),
    radial-gradient(4px 4px at 64% 76%, rgba(255, 215, 122, 0.12), transparent 60%),
    radial-gradient(3px 3px at 28% 66%, rgba(103, 211, 255, 0.14), transparent 60%),
    radial-gradient(3px 3px at 48% 36%, rgba(255, 215, 122, 0.10), transparent 60%);
  opacity: calc(0.38 + (var(--drama) * 0.22));
  animation: sparkleDrift 7s ease-in-out infinite;
}

@keyframes sparkleDrift {
  0% {
    transform: translateY(0px);
    filter: brightness(1);
  }
  50% {
    transform: translateY(-10px);
    filter: brightness(1.1);
  }
  100% {
    transform: translateY(0px);
    filter: brightness(1);
  }
}

.topbar {
  position: sticky;
  top: 0;
  z-index: 10;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 18px;
  border-bottom: 1px solid rgba(103, 211, 255, 0.14);
  background: linear-gradient(180deg, rgba(5, 14, 18, 0.92), rgba(5, 14, 18, 0.65));
  backdrop-filter: blur(8px);
}

.topbar__left {
  display: flex;
  align-items: center;
  gap: 14px;
  min-width: 0;
}

.badge {
  padding: 6px 10px;
  border: 1px solid rgba(255, 215, 122, 0.28);
  border-radius: 999px;
  font-size: 12px;
  color: var(--muted);
  letter-spacing: 0.12em;
  text-transform: uppercase;
  background:
    radial-gradient(220px 90px at 20% 20%, rgba(208, 36, 61, 0.18), transparent 60%),
    radial-gradient(220px 90px at 80% 30%, rgba(31, 143, 84, 0.18), transparent 60%),
    rgba(7, 18, 26, 0.7);
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.28);
}

.topbar__title {
  display: grid;
  gap: 2px;
  min-width: 0;
}

.title {
  font-family: var(--serif);
  font-size: 18px;
  letter-spacing: 0.04em;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.subtitle {
  font-size: 12px;
  color: var(--muted);
  letter-spacing: 0.06em;
  text-transform: uppercase;
}

.topbar__right {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  justify-content: flex-end;
}

.layout {
  position: relative;
  z-index: 2;
  display: grid;
  grid-template-columns: 360px 1fr;
  gap: 18px;
  padding: 18px;
  max-width: 1200px;
  margin: 0 auto;
}

.layout--single {
  grid-template-columns: 1fr;
}

.sidebar {
  display: grid;
  gap: 14px;
}

.stage {
  min-height: 70vh;
}

.panel {
  border-radius: var(--radius);
  background: var(--panel);
  border: 1px solid rgba(103, 211, 255, 0.16);
  box-shadow: 0 18px 60px var(--shadow);
  overflow: hidden;
}

.panel--blueprint {
  background:
    linear-gradient(0deg, rgba(7, 18, 26, 0.92), rgba(7, 18, 26, 0.78)),
    repeating-linear-gradient(0deg, transparent, transparent 18px, var(--grid) 19px, transparent 20px),
    repeating-linear-gradient(90deg, transparent, transparent 18px, var(--grid) 19px, transparent 20px);
}

.panel--stage {
  background: linear-gradient(180deg, rgba(7, 18, 26, 0.86), rgba(7, 18, 26, 0.72));
  padding: 18px;
}

.panel__header {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  padding: 14px 14px 10px 14px;
  border-bottom: 1px solid rgba(103, 211, 255, 0.14);
}

.panel__title {
  font-family: var(--serif);
  letter-spacing: 0.06em;
  text-transform: uppercase;
  font-size: 13px;
  color: rgba(216, 246, 255, 0.92);
}

.panel__meta {
  font-size: 12px;
  color: var(--muted);
}

.btn {
  appearance: none;
  border: 1px solid rgba(103, 211, 255, 0.28);
  background: rgba(7, 18, 26, 0.72);
  color: var(--ink);
  padding: 9px 12px;
  border-radius: 10px;
  cursor: pointer;
  font-family: var(--mono);
  letter-spacing: 0.03em;
  transition: transform 120ms ease, border-color 120ms ease, background 120ms ease;
}

.btn:hover {
  transform: translateY(-1px);
  border-color: rgba(103, 211, 255, 0.5);
}

.btn:active {
  transform: translateY(0px) scale(0.985);
}

.btn:focus-visible {
  outline: 2px solid rgba(255, 215, 122, 0.55);
  outline-offset: 2px;
}

.btn--ghost {
  background: rgba(7, 18, 26, 0.35);
}

.btn--danger {
  border-color: rgba(255, 95, 95, 0.45);
  background: rgba(28, 10, 12, 0.55);
}

.btn--danger:hover {
  border-color: rgba(255, 95, 95, 0.75);
}

.btn--primary {
  border-color: rgba(255, 215, 122, 0.55);
  background:
    radial-gradient(320px 120px at 20% 20%, rgba(255, 215, 122, 0.18), transparent 60%),
    radial-gradient(260px 120px at 80% 30%, rgba(208, 36, 61, 0.12), transparent 60%),
    rgba(34, 22, 10, 0.32);
}

.btn--primary:hover {
  border-color: rgba(255, 215, 122, 0.78);
}

.iconBtn {
  display: inline-flex;
  gap: 10px;
  align-items: center;
}

.icon {
  width: 18px;
  height: 18px;
  opacity: 0.9;
}

.map {
  display: grid;
  padding: 10px;
  gap: 10px;
}

.map__room {
  display: grid;
  grid-template-columns: 16px 1fr 18px;
  align-items: center;
  gap: 10px;
  padding: 10px 10px;
  border-radius: 12px;
  border: 1px solid rgba(103, 211, 255, 0.14);
  background: rgba(7, 18, 26, 0.58);
  color: var(--ink);
  cursor: pointer;
  text-align: left;
}

.map__room:hover {
  border-color: rgba(103, 211, 255, 0.4);
}

.map__room[aria-current="true"] {
  border-color: rgba(255, 215, 122, 0.6);
  background: rgba(34, 22, 10, 0.22);
}

.map__dot {
  width: 10px;
  height: 10px;
  border-radius: 999px;
  background: rgba(103, 211, 255, 0.35);
  box-shadow: 0 0 0 3px rgba(103, 211, 255, 0.12);
}

.map__lock {
  width: 16px;
  height: 16px;
  opacity: 0.8;
  background:
    radial-gradient(circle at 50% 38%, rgba(216, 246, 255, 0.9) 0 2px, transparent 3px),
    linear-gradient(180deg, rgba(216, 246, 255, 0.9), rgba(216, 246, 255, 0.45));
  clip-path: polygon(
    18% 46%,
    18% 35%,
    30% 22%,
    50% 16%,
    70% 22%,
    82% 35%,
    82% 46%,
    76% 46%,
    76% 36%,
    66% 26%,
    50% 22%,
    34% 26%,
    24% 36%,
    24% 46%,
    18% 46%,
    18% 86%,
    82% 86%,
    82% 46%
  );
}

.map__room[data-locked="true"] {
  opacity: 0.55;
}

.map__room[data-locked="true"] .map__dot {
  background: rgba(216, 246, 255, 0.12);
  box-shadow: 0 0 0 3px rgba(216, 246, 255, 0.05);
}

.map__room[data-locked="true"] .map__lock {
  opacity: 1;
}

.map__room[data-locked="false"] .map__lock {
  opacity: 0;
}

.fragments {
  display: grid;
  gap: 10px;
  padding: 12px;
}

.fragment {
  display: grid;
  grid-template-columns: 30px 1fr;
  gap: 10px;
  padding: 10px 12px;
  border: 1px solid rgba(103, 211, 255, 0.2);
  border-radius: 12px;
  background: rgba(7, 18, 26, 0.62);
}

.fragment__label {
  font-size: 12px;
  color: var(--muted);
  letter-spacing: 0.18em;
  align-self: center;
}

.fragment__value {
  font-size: 14px;
  letter-spacing: 0.12em;
}

.fragment--locked {
  border-style: dashed;
  opacity: 0.6;
}

.fragment--unlocked {
  border-color: rgba(255, 215, 122, 0.48);
  background:
    linear-gradient(180deg, rgba(34, 22, 10, 0.26), rgba(7, 18, 26, 0.62)),
    rgba(7, 18, 26, 0.62);
}

.microcopy {
  padding: 10px 14px 14px 14px;
  color: var(--muted);
  font-size: 12px;
  line-height: 1.45;
}

.footer {
  position: relative;
  z-index: 2;
  display: flex;
  justify-content: space-between;
  gap: 12px;
  padding: 16px 18px 24px;
  max-width: 1200px;
  margin: 0 auto;
  color: var(--muted);
  font-size: 12px;
}

.footer__left {
  display: flex;
  align-items: center;
  gap: 10px;
}

.sigil {
  width: 16px;
  height: 16px;
  border-radius: 4px;
  background: linear-gradient(180deg, rgba(255, 215, 122, 0.9), rgba(103, 211, 255, 0.35));
  box-shadow: 0 0 0 3px rgba(103, 211, 255, 0.1);
}

.kbd {
  font-family: var(--mono);
  padding: 2px 6px;
  border-radius: 6px;
  border: 1px solid rgba(103, 211, 255, 0.2);
  background: rgba(7, 18, 26, 0.62);
  color: rgba(216, 246, 255, 0.92);
}

/* Room content */
.room {
  display: grid;
  gap: 14px;
}

.room__kicker {
  font-size: 12px;
  color: var(--muted);
  letter-spacing: 0.1em;
  text-transform: uppercase;
}

.room__title {
  font-family: var(--serif);
  font-size: 28px;
  letter-spacing: 0.03em;
  margin-top: -6px;
}

.room__text {
  color: rgba(216, 246, 255, 0.9);
  line-height: 1.65;
  font-size: 14px;
  max-width: 72ch;
}

.room__ctaRow {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  align-items: center;
}

.divider {
  height: 1px;
  background: rgba(103, 211, 255, 0.14);
  margin: 6px 0;
}

/* Progressive UI */
.focusWrap {
  width: min(980px, 100%);
  margin: 0 auto;
  display: grid;
  gap: 14px;
}

.stepper {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  width: 100%;
}

.steps {
  display: flex;
  gap: 10px;
  align-items: center;
  flex-wrap: wrap;
}

.step {
  display: flex;
  gap: 8px;
  align-items: center;
  padding: 8px 10px;
  border-radius: 999px;
  border: 1px solid rgba(103, 211, 255, 0.16);
  background: rgba(7, 18, 26, 0.46);
  color: rgba(216, 246, 255, 0.9);
  font-size: 12px;
}

.step--active {
  border-color: rgba(255, 215, 122, 0.6);
  background:
    radial-gradient(240px 90px at 20% 20%, rgba(255, 215, 122, 0.12), transparent 60%),
    rgba(34, 22, 10, 0.22);
}

.step__dot {
  width: 8px;
  height: 8px;
  border-radius: 999px;
  background: rgba(103, 211, 255, 0.35);
  box-shadow: 0 0 0 3px rgba(103, 211, 255, 0.12);
}

.step--active .step__dot {
  background: rgba(255, 215, 122, 0.9);
  box-shadow: 0 0 0 3px rgba(255, 215, 122, 0.18);
}

.vaultCard {
  width: min(980px, 100%);
  margin: 0 auto;
  border-radius: 22px;
  border: 1px solid rgba(255, 215, 122, 0.22);
  background:
    radial-gradient(900px 280px at 50% 10%, rgba(255, 215, 122, 0.12), transparent 62%),
    radial-gradient(700px 240px at 18% 22%, rgba(208, 36, 61, 0.12), transparent 62%),
    radial-gradient(700px 240px at 82% 28%, rgba(31, 143, 84, 0.12), transparent 62%),
    linear-gradient(180deg, rgba(7, 18, 26, 0.9), rgba(7, 18, 26, 0.72));
  box-shadow: 0 24px 90px rgba(0, 0, 0, 0.62);
  padding: 18px;
}

.vaultHero {
  display: grid;
  grid-template-columns: 1.2fr 0.8fr;
  gap: 18px;
  align-items: center;
}

.vaultHero__art {
  border-radius: 18px;
  border: 1px solid rgba(103, 211, 255, 0.16);
  background:
    radial-gradient(700px 260px at 40% 30%, rgba(103, 211, 255, 0.08), transparent 62%),
    linear-gradient(180deg, rgba(7, 18, 26, 0.72), rgba(7, 18, 26, 0.42));
  padding: 16px;
  min-height: 180px;
  display: grid;
  place-items: center;
}

.vaultHero__ring {
  width: min(240px, 100%);
  aspect-ratio: 1;
  border-radius: 999px;
  border: 1px solid rgba(255, 215, 122, 0.28);
  background:
    radial-gradient(circle at 50% 50%, rgba(255, 215, 122, 0.16) 0 30%, transparent 60%),
    radial-gradient(circle at 50% 50%, rgba(31, 143, 84, 0.12) 0 24%, transparent 60%),
    radial-gradient(circle at 50% 50%, rgba(208, 36, 61, 0.12) 0 20%, transparent 60%);
  box-shadow: 0 0 0 10px rgba(255, 215, 122, 0.06);
  position: relative;
}

.vaultHero__ring::after {
  content: "";
  position: absolute;
  inset: 18%;
  border-radius: 999px;
  border: 1px dashed rgba(103, 211, 255, 0.26);
}

/* Reward overlay */
.rewardOverlay {
  position: fixed;
  inset: 0;
  z-index: 25;
  display: grid;
  place-items: center;
  padding: 18px;
  background: rgba(0, 0, 0, 0.7);
  backdrop-filter: blur(10px);
}

.rewardOverlay__panel {
  width: min(720px, 100%);
  border-radius: 22px;
  border: 1px solid rgba(255, 215, 122, 0.28);
  background:
    radial-gradient(700px 240px at 50% 20%, rgba(255, 215, 122, 0.16), transparent 65%),
    radial-gradient(560px 220px at 20% 20%, rgba(208, 36, 61, 0.14), transparent 62%),
    radial-gradient(560px 220px at 80% 30%, rgba(31, 143, 84, 0.14), transparent 62%),
    rgba(7, 18, 26, 0.92);
  box-shadow: 0 30px 110px rgba(0, 0, 0, 0.75);
  padding: 18px;
  text-align: center;
}

.rewardOverlay__title {
  font-family: var(--serif);
  font-size: 34px;
  letter-spacing: 0.02em;
}

.rewardOverlay__subtitle {
  color: rgba(216, 246, 255, 0.9);
  line-height: 1.6;
  margin-top: 8px;
}

.rewardOverlay__pill {
  margin: 14px auto 0;
  display: inline-flex;
  gap: 10px;
  align-items: center;
  padding: 10px 12px;
  border-radius: 999px;
  border: 1px solid rgba(255, 215, 122, 0.35);
  background: rgba(34, 22, 10, 0.24);
  letter-spacing: 0.12em;
}

/* Blueprint grid */
.bpGrid {
  display: grid;
  grid-template-columns: repeat(5, minmax(44px, 1fr));
  gap: 10px;
  width: min(520px, 100%);
  padding: 12px;
  border-radius: 16px;
  border: 1px solid rgba(103, 211, 255, 0.16);
  background:
    linear-gradient(180deg, rgba(7, 18, 26, 0.86), rgba(7, 18, 26, 0.62)),
    repeating-linear-gradient(0deg, transparent, transparent 18px, rgba(103, 211, 255, 0.08) 19px, transparent 20px),
    repeating-linear-gradient(90deg, transparent, transparent 18px, rgba(103, 211, 255, 0.08) 19px, transparent 20px);
}

.bpTile {
  height: 52px;
  border-radius: 14px;
  border: 1px solid rgba(103, 211, 255, 0.18);
  background:
    radial-gradient(240px 180px at 30% 20%, rgba(103, 211, 255, 0.08), transparent 65%),
    rgba(7, 18, 26, 0.55);
  cursor: pointer;
  position: relative;
  transition: transform 120ms ease, border-color 120ms ease, background 120ms ease, filter 120ms ease;
}

.bpTile:hover {
  transform: translateY(-1px);
  border-color: rgba(103, 211, 255, 0.42);
  filter: brightness(1.08);
}

.bpTile:focus-visible {
  outline: 2px solid rgba(255, 215, 122, 0.55);
  outline-offset: 2px;
}

.bpTile--wrong {
  border-color: rgba(255, 95, 95, 0.55);
  background: rgba(28, 10, 12, 0.55);
}

.bpOrnament {
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
  color: rgba(255, 215, 122, 0.9);
  text-shadow: 0 0 18px rgba(255, 215, 122, 0.22);
  font-size: 18px;
  opacity: 0.12;
  transition: opacity 120ms ease, filter 120ms ease;
}

.bpTile:hover .bpOrnament {
  opacity: 0.92;
  filter: drop-shadow(0 0 10px rgba(255, 215, 122, 0.18));
}

/* Library shelf */
.shelf {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 10px;
  width: min(720px, 100%);
}

.book {
  text-align: left;
  padding: 12px 12px;
  border-radius: 14px;
  border: 1px solid rgba(103, 211, 255, 0.16);
  background:
    linear-gradient(180deg, rgba(7, 18, 26, 0.74), rgba(7, 18, 26, 0.52)),
    radial-gradient(240px 80px at 20% 20%, rgba(255, 215, 122, 0.06), transparent 60%);
  color: rgba(216, 246, 255, 0.92);
  cursor: pointer;
}

.book:hover {
  border-color: rgba(103, 211, 255, 0.42);
  transform: translateY(-1px);
}

.book:active {
  transform: translateY(0px);
}

.bookmark {
  width: min(720px, 100%);
  border-radius: 14px;
  border: 1px dashed rgba(103, 211, 255, 0.22);
  background: rgba(7, 18, 26, 0.48);
  padding: 10px 12px;
  color: var(--muted);
  font-size: 12px;
  line-height: 1.4;
}

/* Workshop */
.tray {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  align-items: center;
  width: min(720px, 100%);
  padding: 10px;
  border-radius: 16px;
  border: 1px solid rgba(103, 211, 255, 0.16);
  background: rgba(7, 18, 26, 0.46);
}

.fragCard {
  min-width: 140px;
  padding: 12px 12px;
  border-radius: 14px;
  border: 1px solid rgba(255, 215, 122, 0.38);
  background:
    radial-gradient(320px 120px at 20% 20%, rgba(255, 215, 122, 0.14), transparent 60%),
    rgba(7, 18, 26, 0.66);
  color: rgba(216, 246, 255, 0.95);
  letter-spacing: 0.14em;
  cursor: grab;
}

.fragCard:active {
  cursor: grabbing;
}

.slots {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 10px;
  width: min(720px, 100%);
}

.slot {
  height: 56px;
  border-radius: 14px;
  border: 1px dashed rgba(103, 211, 255, 0.22);
  background: rgba(7, 18, 26, 0.46);
  color: rgba(216, 246, 255, 0.92);
  letter-spacing: 0.12em;
  cursor: pointer;
}

.slot--over {
  border-style: solid;
  border-color: rgba(255, 215, 122, 0.6);
  background: rgba(34, 22, 10, 0.22);
}

/* Hearth reveal */
.reveal {
  width: min(720px, 100%);
  border-radius: 18px;
  border: 1px solid rgba(255, 215, 122, 0.32);
  background:
    radial-gradient(800px 260px at 50% 20%, rgba(255, 215, 122, 0.14), transparent 62%),
    linear-gradient(180deg, rgba(34, 22, 10, 0.24), rgba(7, 18, 26, 0.62));
  padding: 16px 16px;
}

.reveal__label {
  color: var(--muted);
  font-size: 12px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
}

.reveal__code {
  margin-top: 8px;
  font-size: 22px;
  letter-spacing: 0.18em;
  font-family: var(--mono);
  color: rgba(216, 246, 255, 0.98);
  text-shadow: 0 0 18px rgba(255, 215, 122, 0.12);
  word-break: break-word;
}

.howto {
  width: min(720px, 100%);
  border-radius: 16px;
  border: 1px solid rgba(103, 211, 255, 0.16);
  background: rgba(7, 18, 26, 0.46);
  padding: 10px 12px;
}

.howto__summary {
  cursor: pointer;
  color: rgba(216, 246, 255, 0.92);
  letter-spacing: 0.04em;
}

.howto__body {
  color: rgba(216, 246, 255, 0.9);
  font-size: 13px;
  line-height: 1.6;
  margin-top: 10px;
}

.howto__link {
  display: inline-block;
  color: rgba(255, 215, 122, 0.92);
  text-decoration: none;
  border-bottom: 1px solid rgba(255, 215, 122, 0.4);
}

.howto__link:hover {
  border-bottom-color: rgba(255, 215, 122, 0.75);
}

/* Responsive */
@media (max-width: 980px) {
  .layout {
    grid-template-columns: 1fr;
  }
  .shelf {
    grid-template-columns: 1fr;
  }
  .slots {
    grid-template-columns: 1fr;
  }
  .vaultHero {
    grid-template-columns: 1fr;
  }
}

/* Reduce motion */
body.reduce-motion * {
  animation-duration: 1ms !important;
  animation-iteration-count: 1 !important;
  transition-duration: 1ms !important;
  scroll-behavior: auto !important;
}

/* High contrast */
body.high-contrast {
  --panel: rgba(0, 0, 0, 0.88);
  --panel2: rgba(0, 0, 0, 0.92);
  --muted: rgba(255, 255, 255, 0.78);
  --grid: rgba(255, 255, 255, 0.1);
}

/* Intro gate */
.intro {
  position: fixed;
  inset: 0;
  z-index: 20;
  display: grid;
  place-items: center;
  padding: 18px;
  background:
    radial-gradient(800px 480px at 50% 30%, rgba(255, 215, 122, 0.14), transparent 60%),
    radial-gradient(1000px 700px at 20% 10%, rgba(103, 211, 255, 0.16), transparent 60%),
    rgba(0, 0, 0, 0.72);
  backdrop-filter: blur(10px);
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

.intro--letter {
  background:
    radial-gradient(900px 520px at 50% 30%, rgba(255, 215, 122, 0.2), transparent 62%),
    radial-gradient(900px 650px at 18% 20%, rgba(208, 36, 61, 0.18), transparent 62%),
    radial-gradient(900px 650px at 82% 18%, rgba(31, 143, 84, 0.18), transparent 62%),
    rgba(0, 0, 0, 0.75);
  /* Default: center the artifact so iPad/iPhone don't show a huge dead zone below */
  place-items: center;
  padding-top: calc(18px + env(safe-area-inset-top));
  padding-bottom: calc(18px + env(safe-area-inset-bottom));
}

.introLetterWrap {
  width: min(980px, 100%);
  position: relative;
  display: grid;
  gap: 14px;
}

.envelopeScene {
  position: relative;
  z-index: 1;
  display: grid;
  place-items: center;
  gap: 12px;
}

.envelopeScene--idle .envelope {
  animation: envelopeIdleFloat 2.8s ease-in-out infinite;
  will-change: transform, filter;
}

.envelopeScene--idle .envelopeFine {
  animation: envelopeFinePulse 1.8s ease-in-out infinite;
}

.envelopeScene--idle .seal:not(.seal--broken) .seal__wax {
  animation: sealIdle 1.25s ease-in-out infinite;
}

.envelopeScene--idle .blueprintSvg {
  animation: blueprintBreath 3.4s ease-in-out infinite;
}

@keyframes envelopeIdleFloat {
  0%,
  100% {
    transform: translate3d(0, 0, 0);
    filter: brightness(1);
  }
  50% {
    transform: translate3d(0, -7px, 0);
    filter: brightness(1.03);
  }
}

@keyframes envelopeFinePulse {
  0%,
  100% {
    opacity: 0.78;
    transform: translateY(0px);
  }
  50% {
    opacity: 0.98;
    transform: translateY(-1px);
  }
}

@keyframes sealIdle {
  0%,
  100% {
    transform: rotate(-2deg) scale(1);
    filter: saturate(1) brightness(1);
  }
  50% {
    transform: rotate(2deg) scale(1.035);
    filter: saturate(1.12) brightness(1.06);
  }
}

@keyframes blueprintBreath {
  0%,
  100% {
    opacity: 0.9;
    filter: saturate(1.05) contrast(1.05);
  }
  50% {
    opacity: 0.98;
    filter: saturate(1.15) contrast(1.08) brightness(1.04);
  }
}

body.reduce-motion .envelopeScene--idle .envelope,
body.reduce-motion .envelopeScene--idle .envelopeFine,
body.reduce-motion .envelopeScene--idle .seal__wax,
body.reduce-motion .envelopeScene--idle .blueprintSvg {
  animation: none !important;
}

.envelope {
  width: min(720px, 100%);
  aspect-ratio: 16 / 10;
  border-radius: 22px;
  border: 1px solid rgba(255, 215, 122, 0.22);
  background: radial-gradient(900px 260px at 50% 10%, rgba(255, 215, 122, 0.14), transparent 62%);
  box-shadow: 0 34px 140px rgba(0, 0, 0, 0.78);
  position: relative;
  overflow: hidden;
  perspective: 1100px;
}

.envelope__body {
  position: absolute;
  inset: 0;
  transform-style: preserve-3d;
  transform: rotateX(7deg) rotateZ(-0.8deg);
}

.envelope__shadow {
  position: absolute;
  inset: 0;
  border-radius: 22px;
  background: radial-gradient(700px 280px at 50% 70%, rgba(0, 0, 0, 0.38), transparent 66%);
  transform: translateZ(-40px) scale(0.98);
  opacity: 0.9;
}

.envelope__back {
  position: absolute;
  inset: 0;
  border-radius: 22px;
  background:
    radial-gradient(900px 420px at 50% 35%, rgba(255, 255, 255, 0.14), rgba(255, 255, 255, 0.06)),
    repeating-linear-gradient(0deg, transparent, transparent 18px, rgba(0, 0, 0, 0.04) 19px, transparent 20px);
  border: 1px solid rgba(0, 0, 0, 0.12);
  transform: translateZ(-8px);
}

.envelope__paper {
  position: absolute;
  left: 16px;
  right: 16px;
  top: 18px;
  bottom: 18px;
  border-radius: 18px;
  background:
    linear-gradient(180deg, rgba(255, 255, 255, 0.12), rgba(255, 255, 255, 0.06)),
    repeating-linear-gradient(0deg, transparent, transparent 18px, rgba(0, 0, 0, 0.04) 19px, transparent 20px);
  border: 1px solid rgba(0, 0, 0, 0.10);
  opacity: 0.95;
  filter: saturate(0.8);
  transform: translateZ(8px) translateY(10px);
  box-shadow: 0 16px 50px rgba(0, 0, 0, 0.22);
}

.envelope__front {
  position: absolute;
  inset: 0;
  border-radius: 22px;
  background:
    linear-gradient(180deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.04)),
    radial-gradient(900px 260px at 50% 20%, rgba(255, 215, 122, 0.12), transparent 62%);
  transform: translateZ(22px);
  pointer-events: none;
}

.envelope__front::before {
  content: "";
  position: absolute;
  left: 0;
  right: 0;
  top: 48%;
  height: 2px;
  background: rgba(0, 0, 0, 0.10);
  opacity: 0.7;
}

.envelope__flap {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  height: 58%;
  transform-origin: 50% 0%;
  transform: translateZ(24px) rotateX(0deg);
  background:
    linear-gradient(180deg, rgba(255, 255, 255, 0.16), rgba(255, 255, 255, 0.08)),
    radial-gradient(600px 220px at 50% 20%, rgba(255, 215, 122, 0.10), transparent 65%);
  clip-path: polygon(0 0, 100% 0, 50% 100%);
  border-bottom: 1px solid rgba(0, 0, 0, 0.10);
  box-shadow: 0 18px 60px rgba(0, 0, 0, 0.25);
}

.envelope--opening .envelope__flap {
  animation: envelopeFlapOpen 980ms cubic-bezier(0.2, 0.9, 0.2, 1) forwards;
}

.envelope--opening .envelope__paper {
  animation: envelopePaperOut 980ms cubic-bezier(0.2, 0.9, 0.2, 1) forwards;
}

.envelope--opening .envelope__body {
  animation: envelopeTilt 980ms cubic-bezier(0.2, 0.9, 0.2, 1) forwards;
}

@keyframes envelopeFlapOpen {
  0% {
    transform: translateZ(24px) rotateX(0deg);
  }
  45% {
    transform: translateZ(24px) rotateX(-75deg);
  }
  100% {
    transform: translateZ(24px) rotateX(-165deg);
  }
}

@keyframes envelopePaperOut {
  0% {
    transform: translateZ(8px) translateY(10px);
  }
  55% {
    transform: translateZ(18px) translateY(-18px);
  }
  100% {
    transform: translateZ(26px) translateY(-46px);
  }
}

@keyframes envelopeTilt {
  0% {
    transform: rotateX(7deg) rotateZ(-0.8deg);
  }
  55% {
    transform: rotateX(10deg) rotateZ(0.6deg);
  }
  100% {
    transform: rotateX(8deg) rotateZ(0deg);
  }
}

.envelopeFine {
  color: rgba(216, 246, 255, 0.78);
  font-size: 12px;
  letter-spacing: 0.18em;
  text-transform: uppercase;
}

.seal--envelope {
  position: absolute;
  left: 50%;
  top: 58%;
  transform: translate(-50%, -50%);
  z-index: 5;
}

.introBackdrop {
  position: absolute;
  inset: -30px -30px -10px -30px;
  border-radius: 28px;
  overflow: hidden;
  opacity: 0.9;
  pointer-events: none;
  filter: saturate(1.05) contrast(1.05);
}

.blueprintSvg {
  width: 100%;
  height: 100%;
  display: block;
  background:
    radial-gradient(1200px 520px at 50% 10%, rgba(103, 211, 255, 0.14), transparent 65%),
    radial-gradient(900px 520px at 20% 20%, rgba(255, 215, 122, 0.08), transparent 60%),
    rgba(7, 18, 26, 0.45);
}

.bpStroke {
  fill: none;
  stroke: rgba(103, 211, 255, 0.55);
  stroke-width: 3;
  stroke-linecap: round;
  stroke-linejoin: round;
  stroke-dasharray: 1400;
  stroke-dashoffset: 1400;
  animation: bpDraw 1.9s ease forwards;
}

.bpStroke--slow {
  stroke: rgba(103, 211, 255, 0.45);
  stroke-width: 3.5;
  animation-duration: 2.6s;
}

.bpStroke--thin {
  stroke-width: 2;
  opacity: 0.9;
  animation-duration: 1.6s;
}

@keyframes bpDraw {
  to {
    stroke-dashoffset: 0;
  }
}

.envelopeScene--idle .bpStroke {
  animation: bpLoop 7.4s linear infinite;
}
.envelopeScene--idle .bpStroke--slow {
  animation-duration: 10.8s;
}
.envelopeScene--idle .bpStroke--thin {
  animation-duration: 6.2s;
}

@keyframes bpLoop {
  0% {
    stroke-dashoffset: 1400;
    opacity: 0.65;
  }
  55% {
    stroke-dashoffset: 0;
    opacity: 0.85;
  }
  100% {
    stroke-dashoffset: -1400;
    opacity: 0.65;
  }
}

body.reduce-motion .envelopeScene--idle .bpStroke {
  animation: none !important;
  stroke-dashoffset: 0;
}

.letter {
  position: relative;
  z-index: 1;
  border-radius: 26px;
  border: 1px solid rgba(255, 215, 122, 0.26);
  background:
    radial-gradient(900px 260px at 50% 0%, rgba(255, 215, 122, 0.18), transparent 62%),
    linear-gradient(180deg, rgba(7, 18, 26, 0.92), rgba(7, 18, 26, 0.78));
  box-shadow: 0 34px 140px rgba(0, 0, 0, 0.78);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  max-height: calc(100dvh - 36px - env(safe-area-inset-top) - env(safe-area-inset-bottom));
  width: min(900px, 100%);
  margin: 0 auto;
}

/* Subtle “blue book” framing (page 1 → this site) */
.blueBookMotif {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
}

.blueBookMotif__spine {
  position: absolute;
  left: -14px;
  top: -18px;
  bottom: -18px;
  width: 38px;
  border-radius: 26px;
  background:
    radial-gradient(120px 260px at 50% 20%, rgba(255, 215, 122, 0.07), transparent 62%),
    linear-gradient(180deg, rgba(103, 211, 255, 0.16), rgba(42, 166, 216, 0.06)),
    rgba(7, 18, 26, 0.22);
  border: 1px solid rgba(103, 211, 255, 0.12);
  box-shadow: 0 10px 36px rgba(0, 0, 0, 0.22);
  opacity: 0.28;
  filter: saturate(1.08);
}

.blueBookMotif__bookmark {
  position: absolute;
  left: auto;
  right: 16px;
  top: -8px;
  width: 14px;
  height: 54px;
  border-radius: 10px;
  background:
    radial-gradient(18px 18px at 50% 20%, rgba(255, 255, 255, 0.16), transparent 60%),
    linear-gradient(180deg, rgba(208, 36, 61, 0.75), rgba(120, 12, 30, 0.75));
  border: 1px solid rgba(255, 215, 122, 0.14);
  opacity: 0.22;
  transform: rotate(-2deg);
}

@media (max-width: 520px) {
  /* On narrow phones this motif can read like “buggy shadows” on the left edge. Keep it ultra subtle. */
  .blueBookMotif__spine,
  .blueBookMotif__bookmark {
    opacity: 0.12;
    box-shadow: none;
  }
}

.letter__top,
.letter__paper,
.letter__bottom {
  position: relative;
  z-index: 1;
}

.letter__top {
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  gap: 12px;
  padding: 14px 14px 10px;
  border-bottom: 1px solid rgba(103, 211, 255, 0.14);
  background: rgba(7, 18, 26, 0.66);
}

.letter__meta {
  min-width: 0;
}

.letter__crest {
  width: 56px;
  height: 56px;
  border-radius: 18px;
  border: 1px solid rgba(255, 215, 122, 0.28);
  background:
    radial-gradient(160px 80px at 20% 20%, rgba(208, 36, 61, 0.18), transparent 60%),
    radial-gradient(160px 80px at 80% 30%, rgba(31, 143, 84, 0.18), transparent 60%),
    rgba(34, 22, 10, 0.26);
  display: grid;
  place-items: center;
  box-shadow: 0 0 0 8px rgba(255, 215, 122, 0.06);
}

.letter__crestIcon {
  width: 28px;
  height: 28px;
  color: rgba(255, 215, 122, 0.92);
}

.letter__kicker {
  font-family: var(--serif);
  font-size: 12px;
  letter-spacing: 0.06em;
  text-transform: none;
  color: var(--muted);
  white-space: nowrap;
}

.letter__sub {
  margin-top: 4px;
  font-family: var(--serif);
  color: rgba(216, 246, 255, 0.9);
  font-size: 12px;
  letter-spacing: 0.04em;
  text-transform: none;
  white-space: nowrap;
}

.letter__paper {
  padding: 18px 18px 14px;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  flex: 1;
}

.letterPager {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  margin-bottom: 10px;
  padding: 0 4px;
}

.letterPager__dots {
  display: flex;
  gap: 8px;
  align-items: center;
}

.letterDot {
  width: 8px;
  height: 8px;
  border-radius: 99px;
  border: 1px solid rgba(103, 211, 255, 0.22);
  background: rgba(7, 18, 26, 0.6);
  opacity: 0.6;
}

.letterDot--on {
  opacity: 1;
  background: rgba(255, 215, 122, 0.32);
  border-color: rgba(255, 215, 122, 0.55);
  box-shadow: 0 0 18px rgba(255, 215, 122, 0.18);
}

.letterPager__count {
  font-size: 12px;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.72);
}

.letter__content {
  border-radius: 22px;
  border: 1px solid rgba(103, 211, 255, 0.14);
  background:
    radial-gradient(900px 260px at 50% 10%, rgba(255, 215, 122, 0.14), transparent 65%),
    radial-gradient(640px 260px at 12% 20%, rgba(208, 36, 61, 0.10), transparent 62%),
    radial-gradient(700px 260px at 86% 24%, rgba(31, 143, 84, 0.10), transparent 62%),
    repeating-linear-gradient(0deg, transparent, transparent 24px, rgba(103, 211, 255, 0.045) 25px, transparent 26px),
    linear-gradient(180deg, rgba(11, 24, 30, 0.76), rgba(7, 18, 26, 0.64));
  padding: 16px;
  max-width: 720px;
  margin: 0 auto;
  box-shadow: inset 0 0 0 1px rgba(255, 215, 122, 0.06);
}

.handLine {
  position: relative;
  overflow: hidden;
  padding: 4px 0;
}

.handLine__ink {
  display: inline-block;
  white-space: pre-wrap;
  font-family: var(--hand);
  font-size: clamp(19px, 3.2vw, 25px);
  line-height: 1.62;
  letter-spacing: 0.002em;
  color: rgba(232, 251, 255, 0.96);
  transform: translateY(4px);
  opacity: 1;
  filter: none;
  text-shadow: 0 1px 0 rgba(0, 0, 0, 0.22);
}

.connorCard {
  width: min(320px, 92%);
  margin: 0 auto 10px;
  position: relative;
  border-radius: 16px;
  overflow: hidden;
  background: rgba(7, 18, 26, 0.22);
  border: 1px solid rgba(216, 246, 255, 0.18);
  box-shadow:
    0 14px 34px rgba(0, 0, 0, 0.28),
    0 0 0 1px rgba(255, 215, 122, 0.08) inset;
}

.connorCard__frame {
  position: absolute;
  inset: 0;
  background:
    linear-gradient(180deg, rgba(255, 255, 255, 0.06), rgba(0, 0, 0, 0)) 0 0 / 100% 100%,
    radial-gradient(120% 80% at 30% 10%, rgba(255, 215, 122, 0.12), rgba(0, 0, 0, 0) 55%);
  pointer-events: none;
}

.connorCard__img {
  display: block;
  width: 100%;
  height: auto;
  max-height: 170px;
  object-fit: cover;
  filter: saturate(1.04) contrast(1.04);
}

.connorCard__cap {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  gap: 10px;
  padding: 10px 12px;
  font-family: var(--hand);
  color: rgba(232, 251, 255, 0.92);
  font-size: 18px;
  letter-spacing: 0.02em;
}

.connorCard__cap2 {
  font-family: var(--mono);
  font-size: 11px;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: rgba(255, 215, 122, 0.78);
}

/* Mobile formatting pass: iPhone SE + small devices */
@media (max-width: 420px) {
  .intro {
    padding: 12px;
  }
  .intro--letter {
    padding-top: calc(12px + env(safe-area-inset-top));
    padding-bottom: calc(12px + env(safe-area-inset-bottom));
    place-items: start stretch;
  }
  .introLetterWrap {
    gap: 10px;
  }
  .envelopeFine {
    font-size: 11px;
    letter-spacing: 0.16em;
  }
  .introLetterFine {
    font-size: 11px;
    letter-spacing: 0.1em;
    padding-left: 2px;
  }
  .letter__top {
    padding: 10px 12px 8px;
  }
  .letter__paper {
    padding: 14px 14px 12px;
  }
  .letter__content {
    padding: 12px;
  }
  .letterPager {
    margin-bottom: 8px;
  }
}

/* Short-height devices: keep everything visible, reduce vertical padding */
@media (max-height: 700px) {
  .letter__top {
    padding: 10px 12px 8px;
  }
  .letter__paper {
    padding: 14px 14px 12px;
  }
  .letter__bottom {
    padding: 10px 12px;
  }
}

/* iPad / larger tablets: let the artifact breathe */
@media (min-width: 768px) {
  .introLetterWrap {
    gap: 16px;
  }
  .letter__top {
    padding: 16px 16px 12px;
  }
  .letter__paper {
    padding: 20px 20px 16px;
  }
  .letter__kicker {
    font-size: 14px;
    letter-spacing: 0.05em;
  }
  .letter__sub {
    font-size: 14px;
    letter-spacing: 0.03em;
  }
  .handLine__ink {
    font-size: clamp(22px, 2.2vw, 28px);
    line-height: 1.65;
  }
}

.handLine--gap {
  padding: 6px 0;
}

/* Page 1 readability: reduce “floaty” whitespace */
.letter__content {
  padding: 14px;
}

.inkRed {
  color: rgba(208, 36, 61, 0.92);
}
.inkGreen {
  color: rgba(31, 143, 84, 0.95);
}
.inkGold {
  color: rgba(255, 215, 122, 0.96);
}
.inkBlue {
  color: rgba(103, 211, 255, 0.98);
}

.letter__content--write .handLine__ink {
  opacity: 0;
  animation: handReveal 900ms ease forwards;
  animation-delay: var(--d);
}

.handLine__stroke {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 4px;
  height: 2px;
  background: linear-gradient(90deg, rgba(255, 215, 122, 0), rgba(255, 215, 122, 0.35), rgba(255, 215, 122, 0));
  transform: scaleX(0);
  transform-origin: left center;
  opacity: 0.65;
}

.letter__content--write .handLine__stroke {
  animation: strokeSweep 700ms ease forwards;
  animation-delay: calc(var(--d) + 220ms);
}

@keyframes handReveal {
  from {
    filter: blur(1.2px);
  }
  to {
    transform: translateY(0px);
    opacity: 1;
    filter: blur(0px);
  }
}

@keyframes strokeSweep {
  to {
    transform: scaleX(1);
    opacity: 0.2;
  }
}

.letter__line {
  font-family: var(--serif);
  font-size: 20px;
  letter-spacing: 0.02em;
  line-height: 1.35;
  margin-bottom: 8px;
}

.letter__para {
  font-family: var(--serif);
  font-size: 16px;
  letter-spacing: 0.01em;
  line-height: 1.6;
  color: rgba(216, 246, 255, 0.92);
  margin: 10px 0;
}

.letter__para--soft {
  color: rgba(216, 246, 255, 0.86);
}

.letter__divider {
  height: 1px;
  background: rgba(255, 215, 122, 0.2);
  margin: 14px 0 12px;
}

.letter__hintRow {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

/* Page-3 utility row: chips left, P.S. right (no giant stretched bar) */
.letter__utilityRow {
  margin-top: 12px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  flex-wrap: wrap;
}

.letter__utilityRow .psTab {
  margin-left: auto;
  justify-self: end;
  width: fit-content;
}

/* Tiny “love” easter egg: P.S. tab */
.psWrap {
  margin-top: 14px;
  display: grid;
  gap: 10px;
}

.psTab {
  appearance: none;
  border: 1px solid rgba(255, 215, 122, 0.24);
  background: rgba(7, 18, 26, 0.38);
  color: rgba(216, 246, 255, 0.86);
  padding: 8px 10px;
  border-radius: 999px;
  font-size: 12px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  cursor: pointer;
  position: relative;
}

.psTab--open {
  border-color: rgba(255, 215, 122, 0.55);
}

.psSpark {
  display: inline-block;
  width: 8px;
  height: 8px;
  margin-left: 8px;
  border-radius: 99px;
  background: rgba(255, 215, 122, 0.75);
  box-shadow: 0 0 14px rgba(255, 215, 122, 0.35);
  animation: cursorBlink 720ms steps(2) infinite;
}

.psNote {
  width: 100%;
  padding: 10px 12px 12px;
  border-radius: 16px;
  border: 1px solid rgba(103, 211, 255, 0.14);
  background: rgba(7, 18, 26, 0.34);
  box-shadow: inset 0 0 0 1px rgba(255, 215, 122, 0.05);
}

.psNote__title {
  font-size: 12px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.78);
  margin-bottom: 4px;
}

.handLine--ps {
  opacity: 0.92;
}

.psPopoverBackdrop {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.42);
  backdrop-filter: blur(7px);
  z-index: 60;
  display: grid;
  place-items: center;
  padding: 18px;
}

.psPopover {
  width: min(520px, calc(100vw - 36px));
  border-radius: 18px;
  border: 1px solid rgba(103, 211, 255, 0.18);
  background:
    radial-gradient(700px 220px at 40% 0%, rgba(255, 215, 122, 0.12), transparent 65%),
    rgba(7, 18, 26, 0.92);
  box-shadow: 0 30px 120px rgba(0, 0, 0, 0.62);
  padding: 12px 14px 14px;
}

.psPopover__top {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  margin-bottom: 4px;
}

.psClose {
  appearance: none;
  border: 1px solid rgba(255, 215, 122, 0.18);
  background: rgba(255, 215, 122, 0.06);
  color: rgba(255, 215, 122, 0.9);
  border-radius: 12px;
  padding: 8px 10px;
  font-size: 12px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  min-height: 40px;
}

.psDoodle {
  margin-top: 8px;
  display: flex;
  gap: 10px;
  align-items: center;
}

.psHeart {
  width: 18px;
  height: 18px;
  background:
    radial-gradient(circle at 35% 35%, rgba(255, 215, 122, 0.9) 0 5px, transparent 6px),
    radial-gradient(circle at 65% 35%, rgba(255, 215, 122, 0.9) 0 5px, transparent 6px),
    radial-gradient(circle at 50% 66%, rgba(255, 215, 122, 0.9) 0 7px, transparent 8px);
  transform: rotate(-12deg);
  opacity: 0.9;
}

.psDomino {
  width: 14px;
  height: 22px;
  border-radius: 6px;
  border: 1px solid rgba(103, 211, 255, 0.24);
  background:
    radial-gradient(circle at 40% 30%, rgba(0, 0, 0, 0.55) 0 1.5px, transparent 2.5px),
    radial-gradient(circle at 60% 70%, rgba(0, 0, 0, 0.55) 0 1.5px, transparent 2.5px),
    linear-gradient(180deg, rgba(255, 255, 255, 0.14), rgba(103, 211, 255, 0.05));
  opacity: 0.6;
}

/* Reduce secondary UI on tiny screens to keep the letter “focused” */
@media (max-width: 520px) {
  .letter__hintRow {
    display: none;
  }
}

.chip {
  display: inline-flex;
  gap: 8px;
  align-items: center;
  padding: 8px 10px;
  border-radius: 999px;
  border: 1px solid rgba(103, 211, 255, 0.16);
  background: rgba(7, 18, 26, 0.52);
  color: rgba(216, 246, 255, 0.92);
  font-size: 12px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

.chip__icon {
  width: 16px;
  height: 16px;
  opacity: 0.9;
}

.letter__sig {
  margin-top: 14px;
  color: rgba(216, 246, 255, 0.9);
}

.letter__sigLine {
  color: var(--muted);
  font-size: 12px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

.letter__sigNames {
  font-family: var(--serif);
  font-size: 20px;
  margin-top: 4px;
}

.letter__bottom {
  display: flex;
  gap: 12px;
  align-items: center;
  justify-content: flex-end;
  padding: 12px 14px 14px;
  border-top: 1px solid rgba(103, 211, 255, 0.14);
  background: rgba(7, 18, 26, 0.62);
  position: sticky;
  bottom: 0;
}

/* Make “tap to reveal” not look like an input */
.letter__content[role="button"] {
  outline: none;
}

.letter__content[role="button"]:focus-visible {
  box-shadow: 0 0 0 3px rgba(103, 211, 255, 0.22);
}

@media (max-width: 520px) {
  /* Phones: use portrait space (avoid “floating card in the middle”) */
  .intro--letter {
    place-items: start stretch;
  }
  .introLetterWrap {
    width: 100%;
    height: 100%;
    gap: 10px;
  }
  .letter {
    max-height: calc(100dvh - 12px - env(safe-area-inset-top) - env(safe-area-inset-bottom));
    width: 100%;
  }
  .letter__paper {
    padding: 14px 14px 12px;
  }
  .letter__content {
    padding: 14px;
  }
  .handLine__ink {
    font-size: 19px;
  }
}

.seal {
  appearance: none;
  border: 0;
  background: transparent;
  padding: 0;
  cursor: pointer;
  position: relative;
  width: 86px;
  height: 86px;
  border-radius: 999px;
}

.seal:disabled {
  cursor: default;
}

.seal__wax {
  position: absolute;
  inset: 0;
  border-radius: 999px;
  background:
    radial-gradient(circle at 30% 28%, rgba(255, 255, 255, 0.08), transparent 30%),
    radial-gradient(circle at 70% 70%, rgba(0, 0, 0, 0.28), transparent 40%),
    radial-gradient(circle at 50% 50%, rgba(208, 36, 61, 0.9), rgba(120, 12, 30, 0.92));
  box-shadow:
    0 18px 40px rgba(0, 0, 0, 0.55),
    0 0 0 10px rgba(208, 36, 61, 0.08);
  transform: rotate(-6deg);
  transition: transform 160ms ease;
}

.seal:hover .seal__wax {
  transform: rotate(-6deg) scale(1.02);
}

.seal__mark {
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
  color: rgba(255, 215, 122, 0.92);
  font-family: var(--serif);
  font-size: 22px;
  letter-spacing: 0.12em;
  text-shadow: 0 0 18px rgba(255, 215, 122, 0.16);
}

.seal--broken .seal__wax {
  animation: sealCrack 540ms ease forwards;
}

.seal--blue .seal__wax {
  background:
    radial-gradient(circle at 30% 28%, rgba(255, 255, 255, 0.10), transparent 30%),
    radial-gradient(circle at 70% 70%, rgba(0, 0, 0, 0.28), transparent 40%),
    radial-gradient(circle at 50% 50%, rgba(103, 211, 255, 0.92), rgba(22, 92, 122, 0.92));
  box-shadow:
    0 18px 40px rgba(0, 0, 0, 0.55),
    0 0 0 12px rgba(103, 211, 255, 0.10);
}

@keyframes sealCrack {
  0% {
    transform: rotate(-6deg) scale(1);
  }
  35% {
    transform: rotate(-2deg) scale(1.03);
    filter: brightness(1.05);
  }
  100% {
    transform: rotate(10deg) scale(0.92);
    filter: brightness(0.95) saturate(1.1);
  }
}

.letter--sealed {
  transform: translateY(8px) scale(0.99);
}

.letter--opening {
  animation: letterUnfold 620ms ease forwards;
}

.letter--open {
  transform: translateY(0) scale(1);
}

@keyframes letterUnfold {
  from {
    transform: translateY(8px) scale(0.985);
  }
  to {
    transform: translateY(0px) scale(1);
  }
}

.introLetterFine {
  position: relative;
  z-index: 1;
  color: rgba(216, 246, 255, 0.78);
  font-size: 12px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  padding-left: 6px;
}

.btn--disabled {
  opacity: 0.55;
  cursor: not-allowed;
}

/* Make the whole experience feel like an artifact, not an app */
.scene {
  position: relative;
  z-index: 2;
  max-width: 1100px;
  margin: 0 auto;
  padding: 18px 18px 98px;
}

.cornerMark {
  position: fixed;
  top: auto;
  left: 14px;
  bottom: calc(74px + env(safe-area-inset-bottom));
  z-index: 1; /* sit behind the main card so it never blocks UI */
  padding: 8px 10px;
  border-radius: 999px;
  border: 1px solid rgba(255, 215, 122, 0.22);
  background:
    radial-gradient(220px 90px at 20% 20%, rgba(208, 36, 61, 0.16), transparent 60%),
    radial-gradient(220px 90px at 80% 30%, rgba(31, 143, 84, 0.16), transparent 60%),
    rgba(7, 18, 26, 0.55);
  color: rgba(216, 246, 255, 0.72);
  letter-spacing: 0.18em;
  font-size: 11px;
  text-transform: uppercase;
  pointer-events: none;
  opacity: 0.22;
}

body[data-stage="terminal"] .cornerMark,
body[data-stage="reward"] .cornerMark,
body[data-stage="final"] .cornerMark {
  opacity: 0.18;
  font-size: 10px;
}

body[data-stage="note"] .cornerMark,
body[data-stage="present"] .cornerMark {
  opacity: 0;
}

.settingsRow {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 10px 8px;
  border-radius: 12px;
  border: 1px solid rgba(103, 211, 255, 0.12);
  background: rgba(7, 18, 26, 0.48);
  color: rgba(216, 246, 255, 0.9);
  font-size: 12px;
  letter-spacing: 0.06em;
  text-transform: uppercase;
}

.settingsRow + .settingsRow {
  margin-top: 8px;
}

.settingsRow__label {
  color: rgba(216, 246, 255, 0.86);
}

/* Modal */
.modalOverlay {
  position: fixed;
  inset: 0;
  z-index: 30;
  display: grid;
  place-items: center;
  padding: 18px;
  background: rgba(0, 0, 0, 0.72);
  backdrop-filter: blur(10px);
}

.modalPanel {
  width: min(560px, 100%);
  border-radius: 22px;
  border: 1px solid rgba(255, 215, 122, 0.28);
  background:
    radial-gradient(700px 240px at 50% 20%, rgba(255, 215, 122, 0.12), transparent 65%),
    rgba(7, 18, 26, 0.92);
  box-shadow: 0 30px 110px rgba(0, 0, 0, 0.75);
  padding: 16px;
}

.modalPanel__title {
  font-family: var(--serif);
  letter-spacing: 0.06em;
  text-transform: uppercase;
  font-size: 12px;
  color: rgba(216, 246, 255, 0.92);
  margin-bottom: 10px;
}

/* Bottom bar */
.bottomBar {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 12;
  padding: 10px 12px calc(10px + env(safe-area-inset-bottom));
  background: linear-gradient(180deg, rgba(5, 14, 18, 0), rgba(5, 14, 18, 0.92));
  backdrop-filter: blur(10px);
  border-top: 1px solid rgba(103, 211, 255, 0.14);
}

.bottomBar__inner {
  max-width: 1100px;
  margin: 0 auto;
  display: flex;
  gap: 10px;
  justify-content: flex-end;
  flex-wrap: wrap;
}

.bottomBtn {
  appearance: none;
  border: 1px solid rgba(103, 211, 255, 0.18);
  background: rgba(7, 18, 26, 0.62);
  color: rgba(216, 246, 255, 0.92);
  padding: 10px 12px;
  border-radius: 999px;
  cursor: pointer;
  display: inline-flex;
  gap: 10px;
  align-items: center;
  transition: transform 120ms ease, border-color 120ms ease, background 120ms ease;
}

.bottomBtn:hover {
  transform: translateY(-1px);
  border-color: rgba(255, 215, 122, 0.45);
}

.bottomBtn:active {
  transform: translateY(0px);
}

.bottomBtn:focus-visible {
  outline: 2px solid rgba(255, 215, 122, 0.55);
  outline-offset: 2px;
}

.bottomBtn__label {
  font-size: 12px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

.bottomBtn--danger {
  border-color: rgba(255, 95, 95, 0.35);
}

.bottomBtn--danger:hover {
  border-color: rgba(255, 95, 95, 0.7);
}

.bottomBtn--ghost {
  border-color: rgba(255, 215, 122, 0.22);
  background: rgba(7, 18, 26, 0.38);
}

.bottomBtn--ghost:hover {
  border-color: rgba(255, 215, 122, 0.5);
}

@media (max-width: 520px) {
  .cornerMark {
    display: none;
  }
  .scene {
    padding-bottom: 120px;
  }
  .bottomBar__inner {
    justify-content: center;
  }

  /* Minimum comfortable tap target */
  .btn,
  .bottomBtn,
  .mcqOpt {
    min-height: 44px;
  }

  .btn {
    padding: 12px 14px;
  }

  .bottomBtn {
    padding: 12px 14px;
  }

  .presentScene__title {
    font-size: 32px;
  }

  .presentScene__sub {
    font-size: 11px;
  }

  .terminalScene__top {
    justify-content: center;
  }

  .terminalBadge {
    width: 100%;
    justify-content: center;
  }

  .terminalRiddle__row {
    grid-template-columns: 1fr;
  }
}

/* Focused views: keep “app controls” out of the way for the first two screens */
body[data-stage="note"] .scene,
body[data-stage="present"] .scene {
  padding-bottom: 40px;
}

/* Present scene */
.presentScene {
  display: grid;
  gap: 10px;
  text-align: center;
  padding: 10px 0 4px;
}

.presentScene__kicker {
  font-size: 12px;
  color: var(--muted);
  letter-spacing: 0.06em;
  text-transform: none;
}

.presentScene__title {
  font-family: var(--serif);
  font-size: 38px;
  letter-spacing: 0.02em;
}

.presentScene__sub {
  color: rgba(216, 246, 255, 0.8);
  font-size: 12px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

.presentStage {
  margin-top: 8px;
  display: grid;
  place-items: center;
  position: relative;
}

.presentBtn {
  appearance: none;
  border: 0;
  background: transparent;
  padding: 0;
  cursor: pointer;
  width: min(860px, 100%);
  position: relative;
  border-radius: 22px;
  outline: none;
}

.presentBtn:focus-visible {
  outline: 2px solid rgba(255, 215, 122, 0.55);
  outline-offset: 4px;
}

.presentCanvasWrap {
  width: 100%;
  aspect-ratio: 16 / 11;
  border-radius: 22px;
  overflow: hidden;
  border: 1px solid rgba(255, 215, 122, 0.22);
  background:
    radial-gradient(700px 280px at 50% 25%, rgba(255, 215, 122, 0.12), transparent 62%),
    radial-gradient(900px 420px at 30% 20%, rgba(103, 211, 255, 0.12), transparent 65%),
    rgba(7, 18, 26, 0.72);
  box-shadow: 0 30px 110px rgba(0, 0, 0, 0.75);
}

.presentFallback {
  width: 100%;
  height: 100%;
  display: grid;
  place-items: center;
  gap: 10px;
  background:
    radial-gradient(700px 280px at 50% 25%, rgba(255, 215, 122, 0.12), transparent 62%),
    radial-gradient(900px 420px at 30% 20%, rgba(103, 211, 255, 0.12), transparent 65%),
    rgba(7, 18, 26, 0.72);
}

.presentFallback__box {
  width: 120px;
  height: 92px;
  border-radius: 18px;
  border: 1px solid rgba(103, 211, 255, 0.22);
  background:
    linear-gradient(180deg, rgba(255, 215, 122, 0.10), rgba(0, 0, 0, 0)),
    rgba(11, 36, 48, 0.85);
  box-shadow: 0 18px 60px rgba(0, 0, 0, 0.55);
  position: relative;
}

.presentFallback__box::before {
  content: "";
  position: absolute;
  left: 50%;
  top: 0;
  bottom: 0;
  width: 12px;
  transform: translateX(-50%);
  background: rgba(255, 215, 122, 0.55);
  opacity: 0.7;
}

.presentFallback__box::after {
  content: "";
  position: absolute;
  left: 0;
  right: 0;
  top: 44%;
  height: 12px;
  background: rgba(255, 215, 122, 0.55);
  opacity: 0.7;
}

.presentFallback__text {
  font-size: 11px;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.86);
}

.presentCanvasWrap--hack {
  animation: hackCanvasJitter 420ms steps(2, end) infinite;
  filter: saturate(1.35) contrast(1.15) brightness(1.02);
}

@keyframes hackCanvasJitter {
  0% {
    transform: translate3d(0, 0, 0);
  }
  50% {
    transform: translate3d(-1px, 1px, 0);
  }
  100% {
    transform: translate3d(1px, -1px, 0);
  }
}

.hackOverlay {
  position: absolute;
  inset: 0;
  border-radius: 22px;
  pointer-events: none;
  opacity: 0;
  z-index: 3;
}

.hackOverlay--on {
  opacity: 1;
  animation: hackFlicker 140ms steps(2, end) infinite, hackZap 560ms ease-out both;
}

.hackOverlay__frame {
  position: absolute;
  inset: 0;
  border-radius: 22px;
  background:
    linear-gradient(180deg, rgba(255, 255, 255, 0.08), rgba(0, 0, 0, 0)),
    repeating-linear-gradient(0deg, rgba(103, 211, 255, 0) 0px, rgba(103, 211, 255, 0.06) 2px, rgba(0, 0, 0, 0) 5px),
    radial-gradient(600px 260px at 50% 40%, rgba(103, 211, 255, 0.16), transparent 60%),
    radial-gradient(500px 260px at 35% 70%, rgba(208, 36, 61, 0.14), transparent 62%);
  mix-blend-mode: screen;
  mask-image: radial-gradient(circle at 50% 45%, rgba(0, 0, 0, 1), rgba(0, 0, 0, 0.22) 72%, rgba(0, 0, 0, 0) 100%);
}

.hackOverlay__lines {
  position: absolute;
  left: 14px;
  right: 14px;
  bottom: 14px;
  padding: 12px 12px;
  border-radius: 16px;
  border: 1px solid rgba(103, 211, 255, 0.18);
  background: rgba(4, 12, 18, 0.58);
  backdrop-filter: blur(8px);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.55);
  overflow: hidden;
}

.hackOverlay--on .hackOverlay__lines {
  animation: hackPanelDrift 1.4s ease-in-out infinite;
}

/* Empty beat overlay (after pop, before hijack) */
.emptyOverlay {
  position: absolute;
  inset: 0;
  border-radius: 22px;
  z-index: 3;
  pointer-events: none;
  display: grid;
  place-items: center;
  background:
    radial-gradient(900px 520px at 50% 30%, rgba(0, 0, 0, 0.55), rgba(0, 0, 0, 0.2)),
    repeating-linear-gradient(180deg, rgba(255, 255, 255, 0.05) 0 1px, transparent 1px 5px);
  mix-blend-mode: screen;
  animation: emptyFlicker 220ms steps(2, end) infinite;
}

.emptyOverlay--persist {
  /* When the hijack overlay appears, keep EMPTY visible but push it into the background. */
  opacity: 0.55;
  mix-blend-mode: normal;
  animation: none;
}

.emptyOverlay--persist .emptyOverlay__panel {
  transform: translateY(6px) scale(0.99);
  background: rgba(4, 12, 18, 0.42);
  border-color: rgba(255, 215, 122, 0.14);
}

.emptyOverlay__panel {
  width: min(420px, calc(100% - 28px));
  border-radius: 18px;
  border: 1px solid rgba(255, 215, 122, 0.18);
  background: rgba(4, 12, 18, 0.62);
  backdrop-filter: blur(10px);
  box-shadow: 0 30px 120px rgba(0, 0, 0, 0.65);
  padding: 14px 14px 12px;
  text-align: center;
}

.emptyOverlay__k {
  font-size: 11px;
  letter-spacing: 0.22em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.72);
}

.emptyOverlay__t {
  margin-top: 8px;
  font-family: var(--serif);
  font-size: 30px;
  letter-spacing: 0.04em;
  color: rgba(255, 215, 122, 0.92);
}

.emptyOverlay__s {
  margin-top: 8px;
  font-size: 12px;
  letter-spacing: 0.06em;
  color: rgba(216, 246, 255, 0.82);
}

@keyframes emptyFlicker {
  0% {
    opacity: 0.82;
    filter: saturate(1.1) contrast(1.05);
  }
  100% {
    opacity: 0.92;
    filter: saturate(1.35) contrast(1.12);
  }
}

@keyframes hackPanelDrift {
  0%,
  100% {
    transform: translateY(0px);
  }
  50% {
    transform: translateY(-2px);
  }
}

.winkOverlay {
  position: absolute;
  left: 14px;
  right: 14px;
  top: 14px;
  z-index: 4;
  border-radius: 16px;
  border: 1px solid rgba(255, 215, 122, 0.22);
  background: rgba(7, 18, 26, 0.70);
  backdrop-filter: blur(10px);
  padding: 12px;
  pointer-events: none;
  box-shadow: 0 20px 80px rgba(0, 0, 0, 0.6);
}

.winkOverlay__title {
  font-size: 12px;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.78);
}

.winkOverlay__msg {
  margin-top: 6px;
  font-family: var(--serif);
  font-size: 18px;
  line-height: 1.25;
  color: rgba(232, 251, 255, 0.98);
}

.winkOverlay__tiny {
  margin-top: 6px;
  font-size: 12px;
  letter-spacing: 0.06em;
  color: rgba(255, 215, 122, 0.82);
}

.hackLine {
  font-size: 11px;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.92);
  opacity: 0;
  transform: translateY(6px);
  animation: hackLineIn 240ms ease forwards;
  animation-delay: calc(var(--d) + 80ms);
}

.hackLine:nth-child(3n) {
  color: rgba(255, 215, 122, 0.9);
}

.hackLine:nth-child(4n) {
  color: rgba(103, 211, 255, 0.95);
}

.hackCta {
  margin-top: 10px;
  font-size: 11px;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  color: rgba(255, 215, 122, 0.92);
  opacity: 0;
  transform: translateY(6px);
}

.hackCta--on {
  opacity: 1;
  transform: translateY(0px);
  animation: hackCtaPulse 740ms ease-in-out infinite;
}

@keyframes hackCtaPulse {
  0%,
  100% {
    filter: brightness(0.95);
    opacity: 0.72;
  }
  50% {
    filter: brightness(1.12);
    opacity: 1;
  }
}
@keyframes hackLineIn {
  to {
    opacity: 1;
    transform: translateY(0px);
  }
}

@keyframes hackFlicker {
  0% {
    transform: translate3d(0, 0, 0);
    filter: hue-rotate(0deg);
  }
  50% {
    transform: translate3d(1px, 0, 0);
    filter: hue-rotate(12deg);
  }
  100% {
    transform: translate3d(-1px, 0, 0);
    filter: hue-rotate(-12deg);
  }
}

@keyframes hackZap {
  0% {
    filter: hue-rotate(-10deg) saturate(1.9) contrast(1.25) brightness(1.12);
  }
  24% {
    filter: hue-rotate(10deg) saturate(2.1) contrast(1.35) brightness(1.18);
  }
  100% {
    filter: hue-rotate(0deg) saturate(1.4) contrast(1.08) brightness(1.02);
  }
}

.sparkFlash {
  position: absolute;
  inset: 0;
  border-radius: 22px;
  pointer-events: none;
  opacity: 0;
  background:
    radial-gradient(520px 260px at 50% 40%, rgba(255, 255, 255, 0.18), transparent 62%),
    radial-gradient(700px 320px at 40% 30%, rgba(255, 215, 122, 0.22), transparent 65%),
    radial-gradient(700px 320px at 60% 70%, rgba(103, 211, 255, 0.18), transparent 65%);
  mix-blend-mode: screen;
}

.sparkFlash--on {
  animation: sparkFlash 260ms ease forwards;
}

@keyframes sparkFlash {
  0% {
    opacity: 0;
    transform: scale(0.98);
  }
  30% {
    opacity: 1;
    transform: scale(1.01);
  }
  100% {
    opacity: 0;
    transform: scale(1.03);
  }
}

.presentCanvas {
  width: 100% !important;
  height: 100% !important;
  display: block;
  touch-action: manipulation;
}

.presentBtn__hud {
  position: absolute;
  left: 50%;
  bottom: 18px;
  transform: translateX(-50%);
  display: grid;
  gap: 8px;
  width: min(420px, calc(100% - 24px));
  pointer-events: none;
}

/* Lootbox ring (Overwatch-ish energy) */
.lootRing {
  position: absolute;
  left: 50%;
  bottom: 54px;
  width: min(520px, 72vw);
  aspect-ratio: 1 / 1;
  transform: translateX(-50%);
  border-radius: 999px;
  pointer-events: none;
  opacity: calc(0.18 + (var(--loot, 0) * 0.62));
  background:
    conic-gradient(
      from 90deg,
      rgba(103, 211, 255, 0) 0deg,
      rgba(103, 211, 255, 0.55) 35deg,
      rgba(255, 215, 122, 0.55) 70deg,
      rgba(208, 36, 61, 0.35) 110deg,
      rgba(103, 211, 255, 0.55) 160deg,
      rgba(31, 143, 84, 0.35) 210deg,
      rgba(255, 215, 122, 0.55) 260deg,
      rgba(103, 211, 255, 0.55) 320deg,
      rgba(103, 211, 255, 0) 360deg
    );
  mix-blend-mode: screen;
  filter: blur(0.2px) saturate(1.2);
  animation: lootSpin calc(2.2s - (var(--loot, 0) * 1.55s)) linear infinite;
}

.lootRing::after {
  content: "";
  position: absolute;
  inset: 10%;
  border-radius: 999px;
  border: 1px solid rgba(255, 215, 122, 0.18);
  box-shadow:
    0 0 0 1px rgba(103, 211, 255, 0.12) inset,
    0 0 60px rgba(103, 211, 255, 0.12);
}

@keyframes lootSpin {
  to {
    transform: translateX(-50%) rotate(360deg);
  }
}

.tapBurst {
  position: absolute;
  inset: -40px;
  pointer-events: none;
  z-index: 6;
  overflow: hidden;
}

.tapBurst__p {
  position: absolute;
  left: 50%;
  top: 48%;
  width: 8px;
  height: 12px;
  border-radius: 2px;
  background: rgba(255, 215, 122, 0.9);
  opacity: 0;
  transform: translate(-50%, -50%) scale(0.7);
  animation: tapBurstFly 520ms ease-out forwards;
  animation-delay: calc(var(--i) * 8ms);
}

.tapBurst__p:nth-child(3n) {
  background: rgba(103, 211, 255, 0.9);
}
.tapBurst__p:nth-child(4n) {
  background: rgba(208, 36, 61, 0.85);
}
.tapBurst__p:nth-child(5n) {
  background: rgba(31, 143, 84, 0.85);
}

@keyframes tapBurstFly {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.75);
  }
  10% {
    opacity: 1;
  }
  100% {
    opacity: 0;
    transform: translate(
        calc(-50% + (cos(var(--i)) * 140px)),
        calc(-50% + (sin(var(--i)) * -180px))
      )
      rotate(calc(var(--i) * 20deg));
  }
}

body.reduce-motion .lootRing,
body.reduce-motion .tapBurst__p {
  animation: none;
}

.presentMeter {
  height: 10px;
  border-radius: 999px;
  border: 1px solid rgba(103, 211, 255, 0.18);
  background: rgba(7, 18, 26, 0.62);
  overflow: hidden;
}

.presentMeter__bar {
  height: 100%;
  width: 100%;
  transform-origin: left center;
  background:
    radial-gradient(240px 90px at 20% 20%, rgba(255, 215, 122, 0.18), transparent 60%),
    rgba(255, 215, 122, 0.28);
}

.presentMeter__text {
  color: rgba(216, 246, 255, 0.82);
  letter-spacing: 0.18em;
  text-transform: uppercase;
  font-size: 11px;
}

.confettiBurst {
  position: absolute;
  inset: -40px -40px -40px -40px;
  pointer-events: none;
  overflow: hidden;
}

.confetti {
  position: absolute;
  left: 50%;
  top: 45%;
  width: 10px;
  height: 18px;
  border-radius: 2px;
  background: rgba(255, 215, 122, 0.9);
  transform: translate(-50%, -50%) rotate(0deg);
  opacity: 0;
  animation: confettiFly 1100ms ease forwards;
  animation-delay: calc(var(--i) * 14ms);
}

.confetti:nth-child(3n) {
  background: rgba(103, 211, 255, 0.9);
}
.confetti:nth-child(4n) {
  background: rgba(208, 36, 61, 0.9);
}
.confetti:nth-child(5n) {
  background: rgba(31, 143, 84, 0.9);
}

.confettiHat {
  position: absolute;
  left: 50%;
  top: 45%;
  width: 14px;
  height: 14px;
  opacity: 0;
  transform: translate(-50%, -50%) scale(0.9) rotate(0deg);
  animation: confettiHatFly 1250ms cubic-bezier(0.16, 0.84, 0.22, 1) forwards;
  animation-delay: calc(var(--i) * 22ms);
  filter: drop-shadow(0 10px 18px rgba(0, 0, 0, 0.35));
}

.confettiHat::before {
  content: "";
  position: absolute;
  inset: 0;
  background:
    radial-gradient(10px 10px at 78% 28%, rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0) 55%),
    linear-gradient(180deg, rgba(208, 36, 61, 0.95), rgba(120, 12, 30, 0.95));
  clip-path: polygon(50% 0%, 82% 34%, 100% 72%, 0% 72%, 18% 34%);
  border-radius: 4px;
}

.confettiHat::after {
  content: "";
  position: absolute;
  left: 50%;
  top: 68%;
  width: 18px;
  height: 4px;
  transform: translateX(-50%);
  border-radius: 99px;
  background: rgba(255, 215, 122, 0.85);
  box-shadow: 0 0 18px rgba(255, 215, 122, 0.18);
}

@keyframes confettiHatFly {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.75);
  }
  10% {
    opacity: 1;
  }
  100% {
    opacity: 0;
    transform: translate(
        calc(-50% + (cos(var(--i)) * 260px)),
        calc(-50% + (sin(var(--i)) * -360px))
      )
      rotate(calc(var(--i) * 46deg));
  }
}

@keyframes confettiFly {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.7);
  }
  10% {
    opacity: 1;
  }
  100% {
    opacity: 0;
    transform: translate(
        calc(-50% + (cos(var(--i)) * 340px)),
        calc(-50% + (sin(var(--i)) * -420px))
      )
      rotate(calc(var(--i) * 28deg));
  }
}

/* If trig functions aren’t supported in calc(), fall back to a simpler burst. */
@supports not (transform: translate(calc(cos(1) * 1px), calc(sin(1) * 1px))) {
  @keyframes confettiFly {
    0% {
      opacity: 0;
      transform: translate(-50%, -50%) scale(0.7);
    }
    10% {
      opacity: 1;
    }
    100% {
      opacity: 0;
      transform: translate(calc(-50% + (var(--i) * 10px)), calc(-50% - 420px)) rotate(calc(var(--i) * 28deg));
    }
  }
}

/* Terminal scene */
.terminalScene {
  display: grid;
  gap: 12px;
  position: relative;
}

/* Linger: subtle red tint until a correct answer clears it (driven by --rage) */
body[data-stage="terminal"] .terminalScene::before {
  content: "";
  position: absolute;
  inset: -40px;
  pointer-events: none;
  z-index: 2;
  opacity: calc(var(--rage, 0) * 0.9);
  transition: opacity 260ms ease;
  background:
    linear-gradient(180deg, rgba(255, 0, 60, 0.16), rgba(0, 0, 0, 0)),
    radial-gradient(900px 520px at 50% 20%, rgba(255, 0, 60, 0.28), transparent 72%),
    radial-gradient(900px 520px at 20% 80%, rgba(255, 90, 90, 0.18), transparent 74%);
  mix-blend-mode: multiply;
  filter: saturate(1.55) contrast(1.12);
}

/* Terminal phase wash (calm -> fun -> intense) */
body[data-stage="terminal"] .terminalScene::after {
  content: "";
  position: absolute;
  inset: -40px;
  pointer-events: none;
  z-index: 1;
  opacity: 0.55;
  transition: opacity 280ms ease, filter 280ms ease;
  mix-blend-mode: screen;
}

body[data-stage="terminal"][data-term-phase="0"] .terminalScene::after {
  opacity: 0.35;
  background:
    radial-gradient(900px 520px at 40% 20%, rgba(103, 211, 255, 0.16), transparent 70%),
    radial-gradient(900px 520px at 70% 80%, rgba(103, 211, 255, 0.10), transparent 72%),
    linear-gradient(180deg, rgba(7, 18, 26, 0), rgba(0, 0, 0, 0.14));
  filter: saturate(1.05);
}

body[data-stage="terminal"][data-term-phase="1"] .terminalScene::after {
  opacity: 0.55;
  background:
    radial-gradient(900px 520px at 40% 20%, rgba(103, 211, 255, 0.18), transparent 70%),
    radial-gradient(900px 520px at 60% 65%, rgba(255, 215, 122, 0.14), transparent 72%),
    linear-gradient(180deg, rgba(7, 18, 26, 0), rgba(0, 0, 0, 0.16));
  filter: saturate(1.22);
}

body[data-stage="terminal"][data-term-phase="2"] .terminalScene::after {
  opacity: 0.75;
  background:
    radial-gradient(900px 520px at 40% 20%, rgba(103, 211, 255, 0.20), transparent 70%),
    radial-gradient(900px 520px at 60% 65%, rgba(255, 215, 122, 0.16), transparent 72%),
    radial-gradient(900px 520px at 50% 40%, rgba(255, 0, 60, 0.14), transparent 70%),
    linear-gradient(180deg, rgba(7, 18, 26, 0), rgba(0, 0, 0, 0.18));
  filter: saturate(1.42) contrast(1.08);
}

.terminalScene > * {
  position: relative;
  z-index: 3;
}

/* Room journey: color-grade the terminal background per room (subtle, readable) */
body[data-stage="terminal"] {
  /* default */
  --roomC1: 103 211 255; /* cyan */
  --roomC2: 255 215 122; /* gold */
  --roomC3: 31 143 84; /* green */
  --roomInk: 232 251 255;
}

body[data-stage="terminal"][data-term-room="R01"] {
  /* Boiler Hall: warm steam */
  --roomC1: 255 215 122;
  --roomC2: 208 36 61;
  --roomC3: 103 211 255;
}
body[data-stage="terminal"][data-term-room="R02"] {
  /* Courtyard: cold */
  --roomC1: 103 211 255;
  --roomC2: 232 251 255;
  --roomC3: 255 215 122;
}
body[data-stage="terminal"][data-term-room="R03"] {
  /* Service Corridor: util green */
  --roomC1: 31 143 84;
  --roomC2: 103 211 255;
  --roomC3: 255 215 122;
}
body[data-stage="terminal"][data-term-room="R04"] {
  /* Gallery: museum gold */
  --roomC1: 255 215 122;
  --roomC2: 103 211 255;
  --roomC3: 31 143 84;
}
body[data-stage="terminal"][data-term-room="R05"] {
  /* Music Room: classic red + gold */
  --roomC1: 208 36 61;
  --roomC2: 255 215 122;
  --roomC3: 103 211 255;
}
body[data-stage="terminal"][data-term-room="R06"] {
  /* Record shelf: neon cyan */
  --roomC1: 103 211 255;
  --roomC2: 255 215 122;
  --roomC3: 208 36 61;
}
body[data-stage="terminal"][data-term-room="R06S"] {
  /* Pantry: warm */
  --roomC1: 255 215 122;
  --roomC2: 31 143 84;
  --roomC3: 208 36 61;
}
body[data-stage="terminal"][data-term-room="R07"] {
  /* Study: calm teal */
  --roomC1: 103 211 255;
  --roomC2: 31 143 84;
  --roomC3: 255 215 122;
}
body[data-stage="terminal"][data-term-room="R08"] {
  /* West stair: darker */
  --roomC1: 103 211 255;
  --roomC2: 208 36 61;
  --roomC3: 255 215 122;
}
body[data-stage="terminal"][data-term-room="R09"] {
  /* Blueprint desk: blueprint blue */
  --roomC1: 103 211 255;
  --roomC2: 103 211 255;
  --roomC3: 255 215 122;
}
body[data-stage="terminal"][data-term-room="R10"] {
  /* Final lock: green */
  --roomC1: 31 255 140;
  --roomC2: 255 215 122;
  --roomC3: 103 211 255;
}

/* Apply the room wash under content (z-index 1 already) */
body[data-stage="terminal"] .terminalScene::after {
  background:
    radial-gradient(900px 520px at 40% 20%, rgb(var(--roomC1) / 0.22), transparent 70%),
    radial-gradient(900px 520px at 60% 65%, rgb(var(--roomC2) / 0.16), transparent 72%),
    radial-gradient(900px 520px at 50% 40%, rgb(var(--roomC3) / 0.14), transparent 70%),
    linear-gradient(180deg, rgba(7, 18, 26, 0), rgba(0, 0, 0, 0.18));
}

/* Epic handoff overlay (present -> access panel) */
.handoffOverlay {
  position: fixed;
  inset: 0;
  z-index: 85;
  display: grid;
  place-items: center;
  padding: 18px;
  background: rgba(0, 0, 0, 0.72);
  backdrop-filter: blur(10px);
  pointer-events: none;
}

.handoffOverlay__panel {
  width: min(520px, calc(100vw - 36px));
  border-radius: 22px;
  border: 1px solid rgba(103, 211, 255, 0.18);
  background:
    radial-gradient(700px 240px at 50% 20%, rgba(103, 211, 255, 0.14), transparent 65%),
    radial-gradient(700px 240px at 50% 20%, rgba(255, 215, 122, 0.10), transparent 70%),
    rgba(7, 18, 26, 0.92);
  box-shadow: 0 34px 140px rgba(0, 0, 0, 0.78);
  padding: 14px 14px 12px;
}

.handoffOverlay__k {
  font-size: 11px;
  letter-spacing: 0.22em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.72);
}

.handoffOverlay__t {
  margin-top: 6px;
  font-size: 18px;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: rgba(255, 215, 122, 0.92);
}

.handoffOverlay__s {
  margin-top: 8px;
  font-size: 13px;
  color: rgba(216, 246, 255, 0.82);
}

.handoffOverlay__bar {
  margin-top: 10px;
  height: 10px;
  border-radius: 999px;
  background: rgba(255, 255, 255, 0.08);
  border: 1px solid rgba(103, 211, 255, 0.14);
  overflow: hidden;
}

.handoffOverlay__barFill {
  height: 100%;
  width: 100%;
  transform-origin: left;
  background: linear-gradient(90deg, rgba(103, 211, 255, 0.88), rgba(255, 215, 122, 0.88));
  animation: handoffFill 1550ms cubic-bezier(0.16, 0.84, 0.22, 1) forwards;
}

@keyframes handoffFill {
  0% {
    transform: scaleX(0.02);
    filter: saturate(1.15);
  }
  100% {
    transform: scaleX(1);
    filter: saturate(1.35);
  }
}

.handoffOverlay__grid {
  position: absolute;
  inset: 0;
  pointer-events: none;
  background:
    linear-gradient(rgba(103, 211, 255, 0.08) 1px, transparent 1px),
    linear-gradient(90deg, rgba(103, 211, 255, 0.08) 1px, transparent 1px);
  background-size: 56px 56px;
  opacity: 0.16;
  mix-blend-mode: screen;
}

.handoffOverlay__noise {
  position: absolute;
  inset: 0;
  pointer-events: none;
  background:
    repeating-linear-gradient(180deg, rgba(255, 255, 255, 0.04) 0 1px, transparent 1px 4px),
    radial-gradient(700px 260px at 50% 50%, rgba(255, 0, 60, 0.08), transparent 70%);
  opacity: 0.25;
  mix-blend-mode: screen;
  animation: handoffJitter 360ms linear infinite;
}

@keyframes handoffJitter {
  0% {
    transform: translate3d(0, 0, 0);
  }
  50% {
    transform: translate3d(-1px, 1px, 0);
  }
  100% {
    transform: translate3d(1px, -1px, 0);
  }
}

/* Bella easter egg overlay (fullscreen video, hold-to-dim) */
.bellaOverlay {
  position: fixed;
  inset: 0;
  z-index: 90;
  background: rgba(0, 0, 0, 0.92);
  display: grid;
  place-items: center;
  touch-action: none;
  -webkit-touch-callout: none;
  user-select: none;
}

.bellaOverlay::before {
  content: "";
  position: absolute;
  inset: 0;
  background: radial-gradient(900px 520px at 50% 40%, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.85));
  opacity: calc(var(--p, 0) * 0.85);
  transition: opacity 80ms linear;
  pointer-events: none;
}

.bellaOverlay__video {
  width: 100vw;
  height: 100vh;
  object-fit: contain;
  filter: brightness(calc(1 - (var(--p, 0) * 0.65))) contrast(1.06) saturate(1.06);
  transform: translateZ(0);
}

.bellaOverlay__hud {
  position: absolute;
  left: 16px;
  right: 16px;
  bottom: calc(16px + env(safe-area-inset-bottom));
  display: grid;
  gap: 8px;
}

.bellaOverlay__title {
  font-size: 12px;
  letter-spacing: 0.22em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.85);
}

.bellaOverlay__hint {
  font-size: 14px;
  color: rgba(255, 215, 122, 0.88);
}

.bellaOverlay__meter {
  height: 8px;
  border-radius: 999px;
  background: rgba(255, 255, 255, 0.10);
  border: 1px solid rgba(103, 211, 255, 0.14);
  overflow: hidden;
}

.bellaOverlay__meterBar {
  height: 100%;
  width: 100%;
  transform-origin: left;
  background: linear-gradient(90deg, rgba(103, 211, 255, 0.85), rgba(255, 215, 122, 0.85));
}

.bellaOverlay--boom {
  animation: bellaBoom 160ms ease-out both;
}

@keyframes bellaBoom {
  0% {
    filter: none;
  }
  100% {
    filter: brightness(1.25) contrast(1.15);
  }
}

/* Slappa easter egg overlay */
.slappaOverlay {
  position: fixed;
  inset: 0;
  z-index: 87;
  background: rgba(0, 0, 0, 0.78);
  display: grid;
  place-items: center;
  pointer-events: auto;
  cursor: pointer;
}

.slappaOverlay__img {
  width: 100vw;
  height: 100vh;
  object-fit: contain;
  filter: contrast(1.05) saturate(1.05);
}

.slappaOverlay__wash {
  position: absolute;
  inset: 0;
  background:
    radial-gradient(900px 520px at 50% 20%, rgba(255, 215, 122, 0.18), transparent 70%),
    radial-gradient(900px 520px at 50% 60%, rgba(31, 255, 140, 0.10), transparent 70%),
    linear-gradient(180deg, rgba(0, 0, 0, 0.32), rgba(0, 0, 0, 0.68));
  mix-blend-mode: screen;
  animation: winPulse 900ms ease-in-out infinite;
}

.slappaOverlay__txt {
  position: absolute;
  left: 14px;
  right: 14px;
  top: calc(12px + env(safe-area-inset-top));
  bottom: auto;
  text-align: center;
}

.slappaOverlay__k {
  font-size: 12px;
  letter-spacing: 0.22em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.82);
}

.slappaOverlay__s {
  margin-top: 8px;
  display: inline-block;
  font-size: 12px;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: rgba(255, 235, 170, 0.92);
  padding: 10px 12px;
  border-radius: 999px;
  border: 1px solid rgba(255, 215, 122, 0.22);
  background: rgba(0, 0, 0, 0.35);
  backdrop-filter: blur(8px);
}

body.reduce-motion .slappaOverlay__wash {
  animation: none;
}

.rageWash {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 86;
  opacity: 0;
  background:
    linear-gradient(180deg, rgba(255, 0, 60, 0.55), rgba(0, 0, 0, 0.55)),
    radial-gradient(900px 520px at 50% 20%, rgba(255, 90, 90, 0.38), transparent 70%),
    repeating-linear-gradient(180deg, rgba(255, 255, 255, 0.06) 0 1px, transparent 1px 5px);
  mix-blend-mode: normal;
  filter: saturate(1.65) contrast(1.22);
}

.rageWash--on {
  opacity: 1;
  animation: rageFlash 980ms ease-out forwards;
}

@keyframes rageFlash {
  0% {
    opacity: 0;
    transform: translateY(8px);
    filter: saturate(1.6) contrast(1.2) brightness(1.05);
  }
  12% {
    opacity: 1;
    transform: translateY(0px);
  }
  55% {
    opacity: 0.85;
  }
  100% {
    opacity: 0;
    transform: translateY(-4px);
    filter: saturate(1.2) contrast(1.05) brightness(1);
  }
}

.terminalOrnaments {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
}

.terminalOrn {
  position: absolute;
  width: 240px;
  height: 180px;
  border-radius: 26px;
  border: 1px solid rgba(103, 211, 255, 0.12);
  background:
    radial-gradient(400px 180px at 40% 20%, rgba(255, 215, 122, 0.10), transparent 65%),
    repeating-linear-gradient(0deg, transparent, transparent 16px, rgba(103, 211, 255, 0.05) 17px, transparent 18px),
    rgba(0, 0, 0, 0.22);
  box-shadow: 0 30px 120px rgba(0, 0, 0, 0.45);
  opacity: calc(0.14 + (var(--drama) * 0.14));
  filter: blur(0.2px);
  transform: rotate(-8deg);
  animation: ornFloat 7.5s ease-in-out infinite;
}

.terminalOrn--a {
  top: -18px;
  right: -80px;
}
.terminalOrn--b {
  bottom: 110px;
  left: -90px;
  transform: rotate(10deg);
  animation-duration: 9.2s;
}
.terminalOrn--c {
  top: 120px;
  left: -70px;
  width: 180px;
  height: 140px;
  transform: rotate(-14deg);
  animation-duration: 8.3s;
}

@keyframes ornFloat {
  0%,
  100% {
    transform: translateY(0px) rotate(var(--r, -8deg));
  }
  50% {
    transform: translateY(-10px) rotate(var(--r, -8deg));
  }
}

/* Final reveal */
.finalScene {
  text-align: center;
  display: grid;
  gap: 12px;
  padding: 22px;
  position: relative;
}

.finalScene__kicker {
  color: rgba(216, 246, 255, 0.8);
  letter-spacing: 0.06em;
  text-transform: none;
  font-size: 12px;
}

.finalScene__title {
  font-family: var(--serif);
  font-size: 44px;
  letter-spacing: 0.02em;
}

.finalScene__code {
  margin: 8px auto 0;
  padding: 14px 12px;
  border-radius: 18px;
  border: 1px solid rgba(255, 215, 122, 0.32);
  background:
    radial-gradient(700px 240px at 50% 20%, rgba(255, 215, 122, 0.16), transparent 65%),
    rgba(0, 0, 0, 0.45);
  font-family: var(--mono);
  font-size: 26px;
  letter-spacing: 0.22em;
  color: rgba(255, 235, 170, 0.98);
  word-break: break-word;
}

.finalScene__actions {
  display: flex;
  justify-content: center;
  gap: 10px;
  flex-wrap: wrap;
  margin-top: 6px;
}

/* Reward celebration screen (steam + golden valves) */
.rewardScene {
  position: relative;
  overflow: hidden;
  text-align: center;
  display: grid;
  gap: 10px;
  padding: 22px;
}

.rewardScene__kicker {
  font-size: 12px;
  letter-spacing: 0.22em;
  text-transform: uppercase;
  color: rgba(31, 255, 140, 0.88);
}

.rewardScene__title {
  margin-top: 2px;
  font-family: var(--serif);
  font-size: 44px;
  letter-spacing: 0.02em;
  color: rgba(232, 251, 255, 0.98);
}

.rewardScene__sub {
  margin-top: 2px;
  color: rgba(216, 246, 255, 0.82);
  font-size: 13px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

.rewardScene__panel {
  margin: 10px auto 0;
  width: min(560px, 100%);
  border-radius: 20px;
  border: 1px solid rgba(255, 215, 122, 0.22);
  background:
    radial-gradient(900px 260px at 50% 10%, rgba(255, 215, 122, 0.12), transparent 65%),
    rgba(7, 18, 26, 0.72);
  padding: 14px;
  box-shadow: inset 0 0 0 1px rgba(103, 211, 255, 0.10);
}

.rewardScene__line {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  gap: 12px;
  padding: 10px 8px;
  border-top: 1px solid rgba(103, 211, 255, 0.10);
}
.rewardScene__line:first-child {
  border-top: 0;
}

.rewardTag {
  font-size: 12px;
  letter-spacing: 0.22em;
  text-transform: uppercase;
  color: rgba(255, 215, 122, 0.88);
  white-space: nowrap;
}

.rewardValue {
  font-family: var(--mono);
  letter-spacing: 0.10em;
  font-size: 16px;
  color: rgba(232, 251, 255, 0.96);
  user-select: text;
}

.rewardScene__mystery {
  margin-top: 16px;
  font-family: var(--serif);
  font-size: 22px;
  color: rgba(232, 251, 255, 0.96);
}

.rewardScene__tiny {
  margin-top: 6px;
  font-size: 12px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.72);
}

.rewardScene__btn {
  margin-top: 10px;
}

.rewardSteam {
  position: absolute;
  inset: -60px;
  pointer-events: none;
  z-index: 0;
  background:
    radial-gradient(420px 220px at 30% 75%, rgba(232, 251, 255, 0.08), transparent 70%),
    radial-gradient(520px 240px at 62% 70%, rgba(232, 251, 255, 0.10), transparent 72%),
    radial-gradient(520px 260px at 50% 35%, rgba(255, 215, 122, 0.06), transparent 70%);
  opacity: 0.85;
  animation: steamDrift 3.6s ease-in-out infinite;
}

@keyframes steamDrift {
  0%,
  100% {
    transform: translate3d(0, 0, 0);
  }
  50% {
    transform: translate3d(0, -18px, 0);
  }
}

.rewardValves {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  opacity: 0.9;
}

.rewardValve {
  position: absolute;
  width: 120px;
  height: 120px;
  border-radius: 999px;
  border: 1px solid rgba(255, 215, 122, 0.28);
  background:
    radial-gradient(90px 90px at 30% 30%, rgba(255, 255, 255, 0.10), transparent 60%),
    radial-gradient(140px 140px at 50% 50%, rgba(255, 215, 122, 0.14), rgba(0, 0, 0, 0) 62%),
    rgba(0, 0, 0, 0.22);
  box-shadow: 0 20px 90px rgba(0, 0, 0, 0.55);
  animation: valveSpin 2.8s linear infinite;
}

.rewardValve::before {
  content: "";
  position: absolute;
  inset: 18px;
  border-radius: 999px;
  border: 1px solid rgba(255, 215, 122, 0.22);
  box-shadow: inset 0 0 0 1px rgba(103, 211, 255, 0.10);
}

.rewardValve::after {
  content: "";
  position: absolute;
  left: 50%;
  top: 50%;
  width: 72px;
  height: 10px;
  transform: translate(-50%, -50%);
  border-radius: 999px;
  background: rgba(255, 215, 122, 0.75);
  box-shadow: 0 0 24px rgba(255, 215, 122, 0.18);
}

.rewardValve--a {
  left: -24px;
  top: 18%;
  animation-duration: 2.6s;
}
.rewardValve--b {
  right: -34px;
  top: 42%;
  width: 150px;
  height: 150px;
  animation-duration: 3.1s;
}
.rewardValve--c {
  left: 10%;
  bottom: -34px;
  width: 160px;
  height: 160px;
  animation-duration: 3.6s;
}

@keyframes valveSpin {
  to {
    transform: rotate(360deg);
  }
}

.rewardConfetti {
  position: absolute;
  inset: -40px;
  pointer-events: none;
  overflow: hidden;
  z-index: 1;
}

.rewardConfetti__p {
  position: absolute;
  left: 50%;
  top: 35%;
  width: 10px;
  height: 18px;
  border-radius: 2px;
  opacity: 0;
  transform: translate(-50%, -50%);
  background: rgba(255, 215, 122, 0.88);
  animation: confettiFly 2000ms ease forwards;
  animation-delay: calc(var(--i) * 10ms);
}

.rewardConfetti__p:nth-child(3n) {
  background: rgba(103, 211, 255, 0.88);
}
.rewardConfetti__p:nth-child(4n) {
  background: rgba(31, 255, 140, 0.75);
}
.rewardConfetti__p:nth-child(5n) {
  background: rgba(208, 36, 61, 0.75);
}
.rewardConfetti__p--domino {
  width: 12px;
  height: 22px;
  border-radius: 4px;
  background: rgba(232, 251, 255, 0.18);
  border: 1px solid rgba(255, 215, 122, 0.22);
}

.rewardScene > *:not(.rewardSteam):not(.rewardValves):not(.rewardConfetti) {
  position: relative;
  z-index: 2;
}

.whisperRain {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 1;
  overflow: hidden;
  opacity: 0.65;
}

.whisperRain__t {
  position: absolute;
  left: var(--x, 50%);
  top: -20px;
  transform: translateX(-50%);
  font-family: ui-serif, Georgia, "Times New Roman", Times, serif;
  font-size: 14px;
  letter-spacing: 0.08em;
  text-transform: lowercase;
  color: rgba(255, 70, 90, 0.55);
  text-shadow: 0 1px 0 rgba(0, 0, 0, 0.55);
  filter: blur(0.2px);
  animation: whisperFall var(--dur, 12s) linear infinite;
  animation-delay: var(--d, 0s);
  mix-blend-mode: screen;
  white-space: nowrap;
}

.whisperRain__t:nth-child(3n) {
  color: rgba(255, 70, 90, 0.40);
  transform: translateX(-50%) scale(0.98);
}
.whisperRain__t:nth-child(4n) {
  color: rgba(255, 120, 120, 0.36);
  letter-spacing: 0.12em;
}

@keyframes whisperFall {
  0% {
    opacity: 0;
    transform: translateX(-50%) translateY(-10px);
  }
  12% {
    opacity: 1;
  }
  100% {
    opacity: 0;
    transform: translateX(-50%) translateY(calc(100vh + 80px));
  }
}

body.reduce-motion .whisperRain {
  display: none;
}

@media (max-height: 740px) {
  .rewardScene__title {
    font-size: 34px;
  }
  .rewardScene__mystery {
    font-size: 18px;
  }
  .rewardValve--b,
  .rewardValve--c {
    display: none;
  }
}

body.reduce-motion .rewardSteam,
body.reduce-motion .rewardValve,
body.reduce-motion .rewardConfetti__p {
  animation: none;
}

.toast {
  position: absolute;
  left: 50%;
  bottom: 18px;
  transform: translateX(-50%);
  padding: 10px 12px;
  border-radius: 999px;
  border: 1px solid rgba(103, 211, 255, 0.22);
  background: rgba(7, 18, 26, 0.72);
  color: rgba(216, 246, 255, 0.92);
  letter-spacing: 0.14em;
  text-transform: uppercase;
  font-size: 12px;
  box-shadow: 0 18px 60px rgba(0, 0, 0, 0.6);
  pointer-events: none;
}

.finalDominos {
  position: relative;
  height: 0;
}

.finalDomino {
  position: absolute;
  width: 64px;
  height: 100px;
  border-radius: 14px;
  background:
    radial-gradient(circle at 32% 28%, rgba(0, 0, 0, 0.55) 0 2px, transparent 3px),
    radial-gradient(circle at 68% 72%, rgba(0, 0, 0, 0.55) 0 2px, transparent 3px),
    radial-gradient(circle at 68% 28%, rgba(0, 0, 0, 0.55) 0 2px, transparent 3px),
    radial-gradient(circle at 32% 72%, rgba(0, 0, 0, 0.55) 0 2px, transparent 3px),
    linear-gradient(180deg, rgba(255, 255, 255, 0.18), rgba(103, 211, 255, 0.06));
  border: 1px solid rgba(103, 211, 255, 0.18);
  opacity: 0.28;
  filter: blur(0.1px);
  pointer-events: none;
}

.finalDomino--a {
  left: 18px;
  top: -176px;
  transform: rotate(-10deg);
}

.finalDomino--b {
  right: 18px;
  top: -160px;
  transform: rotate(12deg);
}

.terminalScene__top {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}

.terminalBadge {
  display: inline-flex;
  gap: 10px;
  align-items: center;
  padding: 10px 12px;
  border-radius: 999px;
  border: 1px solid rgba(103, 211, 255, 0.18);
  background: rgba(7, 18, 26, 0.62);
  color: rgba(216, 246, 255, 0.92);
  letter-spacing: 0.18em;
  text-transform: uppercase;
  font-size: 12px;
}

.terminalWindow {
  border-radius: 18px;
  border: 1px solid rgba(103, 211, 255, 0.18);
  background: rgba(0, 0, 0, 0.68);
  padding: 14px;
  min-height: 220px;
  box-shadow: inset 0 0 0 1px rgba(255, 215, 122, 0.06);
  position: relative;
  overflow: hidden;
}

.terminalLocked {
  width: 100%;
  border-radius: 14px;
  border: 1px dashed rgba(103, 211, 255, 0.22);
  background: rgba(7, 18, 26, 0.52);
  color: rgba(216, 246, 255, 0.82);
  font-size: 12px;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  padding: 14px 12px;
  min-height: 44px;
  display: grid;
  place-items: center;
}

.terminalRiddle--locked {
  opacity: 0.92;
}

/* Cinematic boot overlay (before Room 01) */
.cineBoot {
  position: fixed;
  inset: 0;
  z-index: 88;
  display: grid;
  place-items: center;
  padding: 16px;
  background: rgba(0, 0, 0, 0.78);
  backdrop-filter: blur(10px);
  pointer-events: none;
}

.dsTitle {
  position: fixed;
  inset: 0;
  z-index: 89; /* above cineBoot */
  display: grid;
  place-items: center;
  padding: 16px;
  background: rgba(0, 0, 0, 0.60);
  backdrop-filter: blur(8px);
  cursor: pointer;
}

.dsTitle__panel {
  width: min(760px, calc(100vw - 32px));
  border-radius: 20px;
  padding: 22px 18px;
  text-align: center;
  background:
    radial-gradient(900px 260px at 50% 0%, rgba(255, 0, 60, 0.14), transparent 60%),
    rgba(7, 18, 26, 0.28);
  border: 1px solid rgba(255, 0, 60, 0.22);
  box-shadow:
    0 50px 160px rgba(0, 0, 0, 0.85),
    0 0 0 1px rgba(255, 255, 255, 0.05) inset;
}

.dsTitle__big {
  font-family: ui-serif, Georgia, "Times New Roman", Times, serif;
  font-size: clamp(28px, 5.2vw, 56px);
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: rgba(255, 70, 90, 0.94);
  text-shadow:
    0 1px 0 rgba(0, 0, 0, 0.55),
    0 10px 38px rgba(255, 0, 60, 0.18);
}

.dsTitle__small {
  margin-top: 10px;
  font-family: var(--mono);
  font-size: 12px;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.72);
}

.dsTitle__vignette {
  position: absolute;
  inset: 0;
  pointer-events: none;
  background: radial-gradient(120% 80% at 50% 40%, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.62));
}

.cineBoot__panel {
  width: min(760px, calc(100vw - 32px));
  border-radius: 24px;
  border: 1px solid rgba(103, 211, 255, 0.20);
  background:
    radial-gradient(900px 320px at 50% 18%, rgba(103, 211, 255, 0.18), transparent 65%),
    radial-gradient(700px 260px at 20% 60%, rgba(255, 0, 60, 0.12), transparent 70%),
    rgba(7, 18, 26, 0.92);
  box-shadow: 0 40px 160px rgba(0, 0, 0, 0.85);
  padding: 16px;
  overflow: hidden;
}

.cineBoot__title {
  font-size: 12px;
  letter-spacing: 0.22em;
  text-transform: uppercase;
  color: rgba(255, 215, 122, 0.92);
}

.cineBoot__sub {
  margin-top: 6px;
  font-size: 14px;
  color: rgba(216, 246, 255, 0.82);
}

.cineBoot__win {
  margin-top: 12px;
  border-radius: 18px;
  border: 1px solid rgba(103, 211, 255, 0.16);
  background: rgba(0, 0, 0, 0.56);
  padding: 14px;
  position: relative;
  min-height: min(56vh, 520px);
}

.cineBoot__line {
  font-family: var(--mono);
  font-size: 14px;
  line-height: 1.65;
  letter-spacing: 0.06em;
  color: rgba(232, 251, 255, 0.96);
}

.cineBoot__cursor {
  position: absolute;
  left: 14px;
  bottom: 14px;
  width: 10px;
  height: 18px;
  background: rgba(255, 215, 122, 0.78);
  animation: cursorBlink 720ms steps(2) infinite;
}

.cineBoot__cursor--idle {
  opacity: 0.6;
}

.cineBoot__grid {
  position: absolute;
  inset: 0;
  pointer-events: none;
  background:
    linear-gradient(rgba(103, 211, 255, 0.08) 1px, transparent 1px),
    linear-gradient(90deg, rgba(103, 211, 255, 0.08) 1px, transparent 1px);
  background-size: 56px 56px;
  opacity: 0.14;
  mix-blend-mode: screen;
}

.cineBoot__noise {
  position: absolute;
  inset: 0;
  pointer-events: none;
  background:
    repeating-linear-gradient(180deg, rgba(255, 255, 255, 0.04) 0 1px, transparent 1px 4px),
    radial-gradient(700px 260px at 50% 50%, rgba(255, 0, 60, 0.10), transparent 70%);
  opacity: 0.24;
  mix-blend-mode: screen;
  animation: handoffJitter 360ms linear infinite;
}

@media (max-height: 740px) {
  .cineBoot__win {
    min-height: min(50vh, 420px);
  }
  .cineBoot__line {
    font-size: 13px;
  }
  .terminalWindow {
    min-height: 170px;
    padding: 12px;
  }
  .presentScene {
    gap: 8px;
    padding: 6px 0 2px;
  }
  .presentScene__title {
    font-size: 32px;
  }
  .presentScene__sub {
    font-size: 11px;
    letter-spacing: 0.06em;
  }
}

.terminalWindow::before {
  content: "";
  position: absolute;
  inset: 0;
  background:
    radial-gradient(420px 180px at 18% 18%, rgba(208, 36, 61, 0.10), transparent 60%),
    radial-gradient(420px 180px at 82% 22%, rgba(31, 143, 84, 0.10), transparent 60%),
    repeating-linear-gradient(0deg, transparent, transparent 18px, rgba(103, 211, 255, 0.06) 19px, transparent 20px),
    radial-gradient(700px 240px at 20% 20%, rgba(255, 215, 122, 0.08), transparent 60%);
  opacity: 0.55;
  pointer-events: none;
}

.terminalWindow::after {
  content: "";
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  height: 10px;
  background:
    radial-gradient(circle at 8% 50%, rgba(255, 95, 95, 0.85), rgba(255, 95, 95, 0) 58%),
    radial-gradient(circle at 18% 50%, rgba(255, 215, 122, 0.85), rgba(255, 215, 122, 0) 58%),
    radial-gradient(circle at 28% 50%, rgba(31, 143, 84, 0.85), rgba(31, 143, 84, 0) 58%),
    radial-gradient(circle at 38% 50%, rgba(103, 211, 255, 0.85), rgba(103, 211, 255, 0) 58%),
    radial-gradient(circle at 48% 50%, rgba(255, 95, 95, 0.85), rgba(255, 95, 95, 0) 58%),
    radial-gradient(circle at 58% 50%, rgba(255, 215, 122, 0.85), rgba(255, 215, 122, 0) 58%),
    radial-gradient(circle at 68% 50%, rgba(31, 143, 84, 0.85), rgba(31, 143, 84, 0) 58%),
    radial-gradient(circle at 78% 50%, rgba(103, 211, 255, 0.85), rgba(103, 211, 255, 0) 58%),
    radial-gradient(circle at 88% 50%, rgba(255, 95, 95, 0.85), rgba(255, 95, 95, 0) 58%);
  opacity: 0.22;
  pointer-events: none;
  filter: blur(0.2px);
}

.terminalLine {
  position: relative;
  font-family: var(--mono);
  color: rgba(232, 251, 255, 0.96);
  letter-spacing: 0.04em;
  font-size: 13px;
  line-height: 1.6;
}

.terminalLine__dim {
  opacity: 0.35;
}

.termTag {
  display: inline-block;
  margin-right: 8px;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  opacity: 0.92;
}
.termTag--info {
  color: rgba(103, 211, 255, 0.92);
}
.termTag--ok {
  color: rgba(31, 143, 84, 0.95);
}
.termTag--warn {
  color: rgba(255, 215, 122, 0.95);
}
.termTag--bad {
  color: rgba(255, 95, 95, 0.95);
}
.termText {
  color: rgba(232, 251, 255, 0.92);
}

/* Win moment: whole screen goes green for a few seconds */
.terminalScene--win .terminalWindow {
  border-color: rgba(31, 143, 84, 0.35);
  box-shadow: inset 0 0 0 1px rgba(31, 143, 84, 0.12);
}

.winOverlay {
  position: fixed;
  inset: 0;
  z-index: 89;
  display: grid;
  place-items: center;
  padding: 16px;
  pointer-events: none;
}

.winOverlay__wash {
  position: absolute;
  inset: 0;
  background:
    radial-gradient(900px 520px at 50% 20%, rgba(31, 255, 140, 0.35), transparent 70%),
    radial-gradient(900px 520px at 30% 80%, rgba(31, 143, 84, 0.22), transparent 70%),
    linear-gradient(180deg, rgba(0, 0, 0, 0.35), rgba(0, 0, 0, 0.65));
  opacity: 1;
  mix-blend-mode: screen;
  animation: winPulse 900ms ease-in-out infinite;
}

@keyframes winPulse {
  0%,
  100% {
    filter: saturate(1.25) brightness(1.02);
  }
  50% {
    filter: saturate(1.55) brightness(1.09);
  }
}

.winOverlay__grid {
  position: absolute;
  inset: 0;
  pointer-events: none;
  background:
    linear-gradient(rgba(31, 255, 140, 0.10) 1px, transparent 1px),
    linear-gradient(90deg, rgba(31, 255, 140, 0.10) 1px, transparent 1px);
  background-size: 56px 56px;
  opacity: 0.12;
  mix-blend-mode: screen;
}

.winOverlay__rays {
  position: absolute;
  inset: -12%;
  pointer-events: none;
  background:
    conic-gradient(
      from 10deg,
      rgba(31, 255, 140, 0) 0deg,
      rgba(31, 255, 140, 0.14) 12deg,
      rgba(255, 215, 122, 0.08) 22deg,
      rgba(31, 255, 140, 0) 40deg,
      rgba(103, 211, 255, 0.10) 56deg,
      rgba(31, 255, 140, 0) 72deg
    );
  opacity: 0.22;
  filter: blur(0.4px);
  animation: winRaysSpin 2200ms linear infinite;
}

.winOverlay__halo {
  position: absolute;
  width: min(820px, 110vw);
  height: min(820px, 110vw);
  border-radius: 999px;
  pointer-events: none;
  background:
    radial-gradient(circle at 50% 50%, rgba(31, 255, 140, 0.12), transparent 58%),
    radial-gradient(circle at 50% 50%, rgba(255, 215, 122, 0.12), transparent 68%),
    radial-gradient(circle at 50% 50%, rgba(103, 211, 255, 0.08), transparent 74%);
  opacity: 0.38;
  mix-blend-mode: screen;
  animation: winHalo 900ms ease-in-out infinite;
}

@keyframes winRaysSpin {
  0% {
    transform: translateZ(0) rotate(0deg) scale(0.98);
  }
  100% {
    transform: translateZ(0) rotate(360deg) scale(1.02);
  }
}

@keyframes winHalo {
  0%,
  100% {
    transform: translateZ(0) scale(0.98);
    filter: saturate(1.2) brightness(1.02);
  }
  50% {
    transform: translateZ(0) scale(1.03);
    filter: saturate(1.5) brightness(1.12);
  }
}

.winOverlay__panel {
  width: min(560px, calc(100vw - 32px));
  border-radius: 24px;
  border: 1px solid rgba(31, 255, 140, 0.22);
  background:
    radial-gradient(900px 320px at 50% 18%, rgba(31, 255, 140, 0.18), transparent 65%),
    rgba(7, 18, 26, 0.92);
  box-shadow: 0 40px 160px rgba(0, 0, 0, 0.85);
  padding: 16px;
  position: relative;
  overflow: hidden;
}

.winOverlay__panel::before {
  content: "";
  position: absolute;
  inset: -2px;
  pointer-events: none;
  background:
    radial-gradient(400px 120px at 50% 0%, rgba(255, 215, 122, 0.14), transparent 70%),
    radial-gradient(520px 220px at 50% 20%, rgba(31, 255, 140, 0.12), transparent 62%),
    repeating-linear-gradient(180deg, rgba(255, 255, 255, 0.035) 0 1px, transparent 1px 5px);
  opacity: 0.55;
  mix-blend-mode: screen;
  animation: winPanelScan 680ms linear infinite;
}

@keyframes winPanelScan {
  0% {
    transform: translateY(-2px);
  }
  100% {
    transform: translateY(6px);
  }
}

.winOverlay__icon {
  display: grid;
  place-items: center;
  width: 100%;
  margin-bottom: 10px;
}

.winOverlay__lock {
  width: 58px;
  height: 58px;
  filter: drop-shadow(0 18px 38px rgba(0, 0, 0, 0.45));
  animation: winLockPop 720ms cubic-bezier(0.16, 0.84, 0.22, 1) forwards;
}

.winLock__shackle {
  stroke-dasharray: 120;
  stroke-dashoffset: 120;
  animation: winShackleDraw 420ms ease forwards;
}

@keyframes winLockPop {
  0% {
    transform: translateY(10px) scale(0.92) rotate(-8deg);
    opacity: 0;
  }
  45% {
    transform: translateY(-2px) scale(1.06) rotate(4deg);
    opacity: 1;
  }
  100% {
    transform: translateY(0px) scale(1) rotate(0deg);
    opacity: 1;
  }
}

@keyframes winShackleDraw {
  0% {
    stroke-dashoffset: 120;
  }
  100% {
    stroke-dashoffset: 0;
  }
}

.winOverlay__title {
  font-size: 12px;
  letter-spacing: 0.24em;
  text-transform: uppercase;
  color: rgba(31, 255, 140, 0.92);
}

.winOverlay__sub {
  margin-top: 6px;
  font-size: 18px;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: rgba(232, 251, 255, 0.96);
}

.winOverlay__tiny {
  margin-top: 8px;
  font-size: 13px;
  color: rgba(232, 251, 255, 0.78);
}

.winOverlay__bar {
  margin-top: 12px;
  height: 10px;
  border-radius: 999px;
  background: rgba(255, 255, 255, 0.08);
  border: 1px solid rgba(31, 255, 140, 0.14);
  overflow: hidden;
}

.winOverlay__barFill {
  height: 100%;
  width: 100%;
  transform-origin: left;
  background: linear-gradient(90deg, rgba(31, 255, 140, 0.85), rgba(255, 215, 122, 0.55));
  animation: handoffFill var(--winHold, 7200ms) cubic-bezier(0.16, 0.84, 0.22, 1) forwards;
}

.winOverlay__confetti {
  position: absolute;
  inset: 0;
  pointer-events: none;
  overflow: hidden;
}

.winConf {
  position: absolute;
  left: 50%;
  top: 50%;
  width: 10px;
  height: 18px;
  border-radius: 2px;
  opacity: 0;
  transform: translate(-50%, -50%);
  background: rgba(31, 255, 140, 0.85);
  animation: confettiFly 1600ms ease forwards;
  animation-delay: calc(var(--i) * 6ms);
}

.winConf:nth-child(3n) {
  background: rgba(255, 215, 122, 0.82);
}
.winConf:nth-child(4n) {
  background: rgba(103, 211, 255, 0.82);
}
.winConf:nth-child(5n) {
  background: rgba(255, 95, 95, 0.72);
}
.winConf--domino {
  width: 12px;
  height: 22px;
  border-radius: 4px;
  background: rgba(232, 251, 255, 0.22);
  border: 1px solid rgba(31, 255, 140, 0.28);
}

body.reduce-motion .winOverlay__wash,
body.reduce-motion .winConf {
  animation: none;
}

body.reduce-motion .winOverlay__rays,
body.reduce-motion .winOverlay__halo,
body.reduce-motion .winOverlay__panel::before,
body.reduce-motion .winLock__shackle,
body.reduce-motion .winOverlay__lock {
  animation: none;
}

/* Per-room victory splash (short green screen) */
.roomWinOverlay {
  position: fixed;
  inset: 0;
  z-index: 88;
  display: grid;
  place-items: center;
  padding: 16px;
  pointer-events: auto;
  cursor: pointer;
}

.roomWinOverlay__wash {
  position: absolute;
  inset: 0;
  background:
    radial-gradient(900px 520px at 50% 20%, rgba(31, 255, 140, 0.30), transparent 70%),
    radial-gradient(900px 520px at 30% 80%, rgba(31, 143, 84, 0.22), transparent 72%),
    linear-gradient(180deg, rgba(0, 0, 0, 0.22), rgba(0, 0, 0, 0.62));
  opacity: 1;
  mix-blend-mode: screen;
  animation: winPulse 900ms ease-in-out infinite;
}

.roomWinOverlay__panel {
  width: min(520px, calc(100vw - 32px));
  border-radius: 22px;
  border: 1px solid rgba(31, 255, 140, 0.22);
  background:
    radial-gradient(900px 320px at 50% 18%, rgba(31, 255, 140, 0.14), transparent 65%),
    rgba(7, 18, 26, 0.92);
  box-shadow: 0 40px 160px rgba(0, 0, 0, 0.85);
  padding: 16px;
  text-align: center;
}

.roomWinOverlay__title {
  font-size: 12px;
  letter-spacing: 0.24em;
  text-transform: uppercase;
  color: rgba(31, 255, 140, 0.92);
}

.roomWinOverlay__sub {
  margin-top: 6px;
  font-size: 18px;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: rgba(232, 251, 255, 0.96);
}

.roomWinOverlay__tiny {
  margin-top: 10px;
  font-size: 12px;
  letter-spacing: 0.06em;
  color: rgba(232, 251, 255, 0.75);
}

.roomWinOverlay__bar {
  margin-top: 12px;
  height: 10px;
  border-radius: 999px;
  background: rgba(255, 255, 255, 0.08);
  border: 1px solid rgba(31, 255, 140, 0.14);
  overflow: hidden;
}

.roomWinOverlay__barFill {
  height: 100%;
  width: 100%;
  transform-origin: left;
  background: linear-gradient(90deg, rgba(31, 255, 140, 0.85), rgba(255, 215, 122, 0.55));
  animation: handoffFill var(--roomWinHold, 3400ms) cubic-bezier(0.16, 0.84, 0.22, 1) forwards;
}

body.reduce-motion .roomWinOverlay__wash,
body.reduce-motion .roomWinOverlay__barFill {
  animation: none;
}

.terminalCursor {
  position: absolute;
  left: 14px;
  bottom: 14px;
  width: 10px;
  height: 18px;
  background: rgba(255, 215, 122, 0.75);
  animation: cursorBlink 720ms steps(2) infinite;
}

.terminalCursor--idle {
  opacity: 0.6;
}

@keyframes cursorBlink {
  0%,
  49% {
    opacity: 1;
  }
  50%,
  100% {
    opacity: 0;
  }
}

.terminalRiddle {
  border-radius: 18px;
  border: 1px solid rgba(103, 211, 255, 0.14);
  background: rgba(7, 18, 26, 0.46);
  padding: 12px;
}

.terminalRiddle--error {
  border-color: rgba(255, 95, 95, 0.45);
  box-shadow: inset 0 0 0 1px rgba(255, 95, 95, 0.12);
}

.terminalRiddle__row {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 10px;
  align-items: center;
}

.terminalPrompt {
  border-radius: 16px;
  border: 1px solid rgba(255, 215, 122, 0.22);
  background: rgba(7, 18, 26, 0.44);
  padding: 12px;
  margin-bottom: 10px;
}

.terminalPrompt__label {
  font-size: 12px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.78);
}

.terminalPrompt__text {
  margin-top: 6px;
  font-family: var(--serif);
  font-size: 18px;
  line-height: 1.35;
  letter-spacing: 0.01em;
  color: rgba(232, 251, 255, 0.98);
}

.qWidget {
  margin-top: 10px;
  margin-bottom: 10px;
  border-radius: 16px;
  border: 1px solid rgba(103, 211, 255, 0.14);
  background: rgba(7, 18, 26, 0.32);
  padding: 10px 10px;
}

.qSvg {
  width: 100%;
  height: 96px;
  display: block;
  transition: transform 220ms ease;
}
.bagAir {
  fill: none;
  stroke: rgba(216, 246, 255, 0.6);
  stroke-width: 3;
  stroke-linecap: round;
  stroke-dasharray: 24;
  stroke-dashoffset: 24;
  animation: bagAir 900ms ease infinite;
}

@keyframes bagAir {
  0% {
    opacity: 0.2;
    stroke-dashoffset: 24;
  }
  40% {
    opacity: 0.8;
  }
  100% {
    opacity: 0.15;
    stroke-dashoffset: 0;
  }
}


.fogSweep {
  fill: none;
  stroke: rgba(216, 246, 255, 0.28);
  stroke-width: 5;
  stroke-linecap: round;
  stroke-dasharray: 140;
  stroke-dashoffset: 140;
  animation: fogSweep 1400ms ease-in-out infinite;
}

.fogSweep--d2 {
  stroke: rgba(255, 215, 122, 0.18);
  animation-delay: 180ms;
}

@keyframes fogSweep {
  0% {
    opacity: 0.05;
    stroke-dashoffset: 140;
  }
  35% {
    opacity: 0.38;
  }
  100% {
    opacity: 0.02;
    stroke-dashoffset: 0;
  }
}

.nightGlow {
  fill: rgba(255, 215, 122, 0.06);
  stroke: rgba(255, 215, 122, 0.12);
  stroke-width: 2;
  opacity: 0.55;
  animation: nightGlow 1.6s ease-in-out infinite;
}

@keyframes nightGlow {
  0%,
  100% {
    transform: scale(0.98);
    opacity: 0.4;
  }
  50% {
    transform: scale(1.04);
    opacity: 0.7;
  }
}

.nightStar {
  fill: rgba(103, 211, 255, 0.28);
  opacity: 0.6;
  animation: nightStar 1.8s ease-in-out infinite;
}

@keyframes nightStar {
  0%,
  100% {
    opacity: 0.35;
  }
  50% {
    opacity: 0.85;
  }
}

.qCard {
  display: grid;
  gap: 8px;
  align-items: center;
  justify-items: center;
  padding: 8px 8px;
}

.qTiny {
  font-size: 11px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.75);
}

.qTiny--muted {
  color: rgba(216, 246, 255, 0.62);
}

.qEq {
  gap: 10px;
}

.qEq__bars {
  width: 100%;
  display: grid;
  grid-template-columns: repeat(14, 1fr);
  gap: 4px;
  align-items: end;
  padding: 6px 4px;
}

.qEq__bar {
  height: 14px;
  border-radius: 4px;
  background: rgba(255, 215, 122, 0.65);
  opacity: 0.9;
  animation: qEqBounce 740ms ease-in-out infinite;
  animation-delay: calc(var(--i) * 35ms);
  transform-origin: bottom;
}

.qEq__bar:nth-child(3n) {
  background: rgba(103, 211, 255, 0.7);
}
.qEq__bar:nth-child(4n) {
  background: rgba(31, 255, 140, 0.6);
}
.qEq__bar:nth-child(5n) {
  background: rgba(255, 95, 95, 0.55);
}

.qEq--m1 .qEq__bar {
  animation-duration: 560ms;
}
.qEq--m2 .qEq__bar {
  animation-duration: 430ms;
}

@keyframes qEqBounce {
  0%,
  100% {
    transform: scaleY(0.35);
    filter: brightness(1);
    opacity: 0.6;
  }
  50% {
    transform: scaleY(1.35);
    filter: brightness(1.12);
    opacity: 0.95;
  }
}

.qDots {
  width: 100%;
  height: 18px;
  border-radius: 999px;
  background:
    radial-gradient(circle at 18% 50%, rgba(255, 215, 122, 0.55), transparent 40%),
    radial-gradient(circle at 38% 50%, rgba(103, 211, 255, 0.55), transparent 40%),
    radial-gradient(circle at 58% 50%, rgba(31, 143, 84, 0.55), transparent 40%),
    radial-gradient(circle at 78% 50%, rgba(208, 36, 61, 0.55), transparent 40%);
  opacity: 0.9;
}

.qNote {
  width: 100%;
  display: grid;
  gap: 6px;
  padding: 8px 8px;
  border-radius: 14px;
  border: 1px solid rgba(255, 215, 122, 0.14);
  background: rgba(0, 0, 0, 0.28);
}

.qNote__line {
  font-size: 11px;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.82);
  opacity: 0.95;
}

.qCardBtn {
  appearance: none;
  border: 0;
  background: transparent;
  padding: 0;
  width: 100%;
  cursor: pointer;
  color: inherit;
  min-height: 72px;
}

.qWordCard {
  gap: 10px;
}

.qWord {
  display: flex;
  align-items: baseline;
  justify-content: center;
  font-family: var(--mono);
  font-size: 28px;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: rgba(232, 251, 255, 0.96);
  text-shadow: 0 16px 60px rgba(0, 0, 0, 0.55);
}

.qWord--mask {
  letter-spacing: 0.12em;
}

.qMask,
.qMaskAdd {
  display: inline-flex;
  gap: 10px;
  align-items: center;
}

.qMaskAdd {
  margin-left: 10px;
  opacity: 0;
  transform: translateX(-10px) scale(0.98);
  transition: opacity 160ms ease, transform 220ms cubic-bezier(0.16, 0.84, 0.22, 1);
}

.qMask__seg {
  width: 14px;
  height: 22px;
  border-radius: 6px;
  background: rgba(232, 251, 255, 0.18);
  border: 1px solid rgba(103, 211, 255, 0.16);
  box-shadow: 0 10px 36px rgba(0, 0, 0, 0.28);
}

.qMask__seg--gold {
  background: rgba(255, 215, 122, 0.26);
  border-color: rgba(255, 215, 122, 0.22);
}

.qWord--on .qMaskAdd {
  opacity: 1;
  transform: translateX(0px) scale(1);
  animation: qWordPop 260ms cubic-bezier(0.16, 0.84, 0.22, 1);
}

.qShrink {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 6px;
  margin-top: 6px;
}

.qShrink__label {
  font-family: var(--mono);
  font-size: 11px;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.55);
}

.qShrink__bar {
  width: min(220px, 70%);
  height: 8px;
  border-radius: 999px;
  background: rgba(255, 255, 255, 0.07);
  box-shadow:
    inset 0 0 0 1px rgba(103, 211, 255, 0.12),
    0 10px 34px rgba(0, 0, 0, 0.24);
  overflow: hidden;
}

.qShrink__fill {
  display: block;
  height: 100%;
  width: 100%;
  transform-origin: left;
  transform: scaleX(1);
  background: linear-gradient(90deg, rgba(103, 211, 255, 0.65), rgba(255, 215, 122, 0.55));
  transition: transform 260ms cubic-bezier(0.16, 0.84, 0.22, 1);
}

.qShrink--on .qShrink__fill {
  transform: scaleX(0.64);
}

.qWord__add {
  display: inline-block;
  margin-left: 6px;
  color: rgba(255, 215, 122, 0.95);
  opacity: 0;
  transform: translateX(-10px) scale(0.94);
  transition: opacity 160ms ease, transform 220ms cubic-bezier(0.16, 0.84, 0.22, 1);
  will-change: transform, opacity;
}

.qWord--on .qWord__add {
  opacity: 1;
  transform: translateX(0px) scale(1);
  animation: qWordPop 260ms cubic-bezier(0.16, 0.84, 0.22, 1);
}

@keyframes qWordPop {
  0% {
    filter: brightness(1) saturate(1);
  }
  40% {
    filter: brightness(1.12) saturate(1.22);
  }
  100% {
    filter: brightness(1.02) saturate(1.05);
  }
}

.qSvg--drift0 {
  animation: chartDrift 2.6s ease-in-out infinite;
}
.qSvg--drift1 {
  animation: chartDrift 2.6s ease-in-out infinite reverse;
}

@keyframes chartDrift {
  0%,
  100% {
    transform: translateX(0px);
    filter: brightness(1);
  }
  50% {
    transform: translateX(-8px);
    filter: brightness(1.05);
  }
}

.qBars {
  display: flex;
  gap: 3px;
  align-items: flex-end;
  height: 44px;
}

.qBar {
  width: 6px;
  height: calc(12px + (var(--i) * 2px));
  border-radius: 3px;
  background: rgba(103, 211, 255, 0.55);
  animation: barPulse 820ms ease-in-out infinite;
  animation-delay: calc(var(--i) * 40ms);
}

@keyframes barPulse {
  0%,
  100% {
    transform: scaleY(0.55);
    opacity: 0.6;
  }
  50% {
    transform: scaleY(1);
    opacity: 0.95;
  }
}

.qDominoRow {
  display: flex;
  gap: 10px;
  justify-content: center;
  align-items: center;
  padding: 8px 0 6px;
  transition: transform 260ms cubic-bezier(0.2, 0.9, 0.2, 1), filter 260ms ease;
}

.qDominoRow--f0 {
  transform: rotate(-2deg) scale(1);
}
.qDominoRow--f1 {
  transform: rotate(4deg) scale(1.08);
  filter: saturate(1.25) contrast(1.08);
}

.qDominoTile {
  width: 44px;
  height: 70px;
  border-radius: 12px;
  border: 1px solid rgba(103, 211, 255, 0.22);
  background:
    /* left tile pips: 6|3 = 9 total */
    radial-gradient(circle at 30% 18%, rgba(0, 0, 0, 0.55) 0 3px, transparent 4px),
    radial-gradient(circle at 70% 18%, rgba(0, 0, 0, 0.55) 0 3px, transparent 4px),
    radial-gradient(circle at 30% 30%, rgba(0, 0, 0, 0.55) 0 3px, transparent 4px),
    radial-gradient(circle at 70% 30%, rgba(0, 0, 0, 0.55) 0 3px, transparent 4px),
    radial-gradient(circle at 30% 42%, rgba(0, 0, 0, 0.55) 0 3px, transparent 4px),
    radial-gradient(circle at 70% 42%, rgba(0, 0, 0, 0.55) 0 3px, transparent 4px),
    radial-gradient(circle at 50% 66%, rgba(0, 0, 0, 0.55) 0 3px, transparent 4px),
    radial-gradient(circle at 30% 78%, rgba(0, 0, 0, 0.55) 0 3px, transparent 4px),
    radial-gradient(circle at 70% 78%, rgba(0, 0, 0, 0.55) 0 3px, transparent 4px),
    linear-gradient(180deg, rgba(255, 255, 255, 0.18), rgba(103, 211, 255, 0.06));
  box-shadow: 0 16px 50px rgba(0, 0, 0, 0.35);
  position: relative;
  transition: transform 260ms cubic-bezier(0.2, 0.9, 0.2, 1), box-shadow 260ms ease, opacity 260ms ease;
}

.qDominoTile--b {
  opacity: 0.78;
  transform: rotate(8deg);
}

.qDominoRow--f1 .qDominoTile {
  transform: rotate(-10deg) translateY(-2px);
  box-shadow: 0 22px 70px rgba(0, 0, 0, 0.45);
}

.qDominoRow--f1 .qDominoTile--b {
  opacity: 0.92;
  transform: rotate(14deg) translateY(1px);
}

.qDominoTile::after {
  content: "";
  position: absolute;
  left: 9px;
  right: 9px;
  top: 50%;
  height: 1px;
  background: rgba(103, 211, 255, 0.18);
}

.qMetro {
  width: 100%;
  height: 52px;
  border-radius: 14px;
  border: 1px solid rgba(255, 215, 122, 0.22);
  background: rgba(0, 0, 0, 0.35);
  position: relative;
  overflow: hidden;
}

.qMetro::before {
  content: "";
  position: absolute;
  left: 50%;
  top: 6px;
  bottom: 6px;
  width: 3px;
  background: rgba(255, 215, 122, 0.7);
  transform-origin: bottom center;
  animation: metroSwing 720ms ease-in-out infinite;
}

.qMetro--still::before {
  animation: none;
  transform: translateX(-50%) rotate(0deg);
}

@keyframes metroSwing {
  0%,
  100% {
    transform: translateX(-50%) rotate(-18deg);
  }
  50% {
    transform: translateX(-50%) rotate(18deg);
  }
}

.qKeyhole {
  width: 54px;
  height: 54px;
  border-radius: 999px;
  border: 1px solid rgba(255, 215, 122, 0.24);
  background:
    radial-gradient(circle at 50% 40%, rgba(255, 215, 122, 0.14), transparent 60%),
    rgba(7, 18, 26, 0.42);
  position: relative;
  box-shadow: 0 20px 70px rgba(0, 0, 0, 0.55);
}

.qKeyhole::after {
  content: "";
  position: absolute;
  left: 50%;
  top: 16px;
  width: 10px;
  height: 10px;
  border-radius: 99px;
  background: rgba(216, 246, 255, 0.75);
  transform: translateX(-50%);
  box-shadow: 0 14px 0 rgba(216, 246, 255, 0.75);
  opacity: 0.8;
  animation: keyPulse 920ms ease-in-out infinite;
}

.qKeyhole--still::after {
  animation: none;
}

@keyframes keyPulse {
  0%,
  100% {
    transform: translateX(-50%) scale(0.95);
    opacity: 0.65;
  }
  50% {
    transform: translateX(-50%) scale(1.05);
    opacity: 0.95;
  }
}

@media (max-width: 520px) {
  .qWidget {
    padding: 8px 8px;
    margin-top: 8px;
    margin-bottom: 8px;
  }
  .qSvg {
    height: 76px;
  }
  .qDominoTile {
    width: 42px;
    height: 64px;
  }
  .qMetro {
    height: 46px;
  }
}

.mcqGrid {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 10px;
}

.mcqOpt {
  appearance: none;
  border: 1px solid rgba(103, 211, 255, 0.18);
  background: rgba(7, 18, 26, 0.62);
  color: rgba(216, 246, 255, 0.92);
  padding: 10px 10px;
  border-radius: 14px;
  cursor: pointer;
  text-align: left;
  letter-spacing: 0.02em;
  text-transform: none;
  transition: transform 120ms ease, border-color 120ms ease, filter 120ms ease;
  min-height: 44px;
}

.mcqOpt:hover {
  transform: translateY(-1px);
  border-color: rgba(255, 215, 122, 0.45);
  filter: brightness(1.05);
}

.mcqOpt:active {
  transform: translateY(0px) scale(0.99);
}

.mcqOpt:focus-visible {
  outline: 2px solid rgba(255, 215, 122, 0.55);
  outline-offset: 2px;
}

.mcqOpt--on {
  border-color: rgba(255, 215, 122, 0.65);
  background: rgba(34, 22, 10, 0.28);
}

/* Reduce motion: keep things crisp and mostly static */
body.reduce-motion .btn,
body.reduce-motion .mcqOpt {
  transition: none;
}

body.reduce-motion .btn:hover,
body.reduce-motion .mcqOpt:hover {
  transform: none;
}

body.reduce-motion .sparkFlash--on,
body.reduce-motion .hackOverlay--on,
body.reduce-motion .presentCanvasWrap--hack,
body.reduce-motion .snowSparkle {
  animation: none;
}

.bpPair {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 10px;
}

.bpCardBtn {
  appearance: none;
  text-align: left;
  cursor: pointer;
  width: 100%;
  border: 0;
  padding: 10px;
  border-radius: 16px;
  background: rgba(7, 18, 26, 0.52);
  border: 1px solid rgba(103, 211, 255, 0.16);
  position: relative;
}

.bpCard {
  border-radius: 16px;
  border: 1px solid rgba(103, 211, 255, 0.16);
  background: rgba(7, 18, 26, 0.52);
  padding: 10px;
}

.bpCard--painting {
  position: relative;
  background:
    radial-gradient(420px 160px at 40% 0%, rgba(255, 215, 122, 0.08), transparent 65%),
    rgba(7, 18, 26, 0.52);
  box-shadow: 0 18px 70px rgba(0, 0, 0, 0.4);
  overflow: hidden;
}

.bpCard--painting::before {
  content: "";
  position: absolute;
  inset: 10px;
  border-radius: 12px;
  pointer-events: none;
  background:
    radial-gradient(400px 200px at 50% 20%, rgba(255, 255, 255, 0.08), transparent 65%),
    repeating-linear-gradient(0deg, rgba(255, 255, 255, 0.00) 0px, rgba(255, 255, 255, 0.03) 2px, rgba(0, 0, 0, 0.00) 6px);
  mix-blend-mode: screen;
  opacity: 0.35;
}

.bpCard--painting::after {
  content: "";
  position: absolute;
  inset: 10px;
  border-radius: 12px;
  pointer-events: none;
  background:
    radial-gradient(220px 140px at 30% 20%, rgba(0, 0, 0, 0.25), transparent 70%),
    radial-gradient(220px 140px at 70% 80%, rgba(0, 0, 0, 0.22), transparent 70%);
  opacity: 0.6;
}

.bpPhoto {
  width: 100%;
  height: 100%;
  display: block;
  aspect-ratio: 1 / 1;
  object-fit: cover;
  border-radius: 12px;
  filter: contrast(1.05) saturate(0.92) brightness(0.98);
  opacity: 0.95;
  transform: translateZ(0);
}

.bpCard--painting:hover .bpPhoto {
  filter: contrast(1.07) saturate(0.98) brightness(1.02);
}

.bpFrame {
  position: absolute;
  inset: 8px;
  border-radius: 14px;
  border: 1px solid rgba(255, 215, 122, 0.26);
  box-shadow:
    inset 0 0 0 2px rgba(0, 0, 0, 0.25),
    0 18px 60px rgba(0, 0, 0, 0.35);
  pointer-events: none;
  opacity: 0.85;
}

.bpPlacard {
  margin-top: 10px;
  font-size: 11px;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.78);
  padding: 8px 10px;
  border-radius: 12px;
  border: 1px solid rgba(255, 215, 122, 0.18);
  background: rgba(0, 0, 0, 0.22);
}

.bpLightbox {
  position: fixed;
  inset: 0;
  z-index: 70;
  display: grid;
  place-items: center;
  padding: 16px;
  background: rgba(0, 0, 0, 0.72);
  backdrop-filter: blur(10px);
}

.bpLightbox__panel {
  width: min(740px, calc(100vw - 32px));
  border-radius: 22px;
  border: 1px solid rgba(255, 215, 122, 0.22);
  background:
    radial-gradient(700px 240px at 50% 20%, rgba(255, 215, 122, 0.14), transparent 65%),
    rgba(7, 18, 26, 0.92);
  box-shadow: 0 30px 120px rgba(0, 0, 0, 0.72);
  padding: 12px;
}

.bpLightbox__img {
  width: 100%;
  max-height: min(62vh, 560px);
  object-fit: contain;
  display: block;
  border-radius: 16px;
  border: 1px solid rgba(103, 211, 255, 0.14);
  background: rgba(0, 0, 0, 0.35);
}

.bpLightbox__hint {
  margin-top: 10px;
  font-size: 12px;
  letter-spacing: 0.08em;
  color: rgba(216, 246, 255, 0.78);
}

.bpLightbox__close {
  margin-top: 10px;
  appearance: none;
  border: 1px solid rgba(255, 215, 122, 0.18);
  background: rgba(255, 215, 122, 0.06);
  color: rgba(255, 215, 122, 0.9);
  border-radius: 12px;
  padding: 10px 12px;
  font-size: 12px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  min-height: 44px;
}

.fixerCard {
  position: relative;
}

.fixerCard::before {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  background:
    repeating-linear-gradient(0deg, rgba(255, 255, 255, 0) 0px, rgba(255, 255, 255, 0.03) 2px, rgba(0, 0, 0, 0) 6px),
    radial-gradient(520px 220px at 50% 10%, rgba(103, 211, 255, 0.10), transparent 62%);
  opacity: calc(0.28 + (var(--drama) * 0.22));
  mix-blend-mode: screen;
}

.bpIllo {
  width: 100%;
  height: auto;
  display: block;
}

.fixerCard {
  border-radius: 18px;
  border: 1px solid rgba(255, 215, 122, 0.22);
  background: rgba(0, 0, 0, 0.35);
  overflow: hidden;
  box-shadow: inset 0 0 0 1px rgba(103, 211, 255, 0.12);
  margin-bottom: 10px;
}

.fixerCard__img {
  width: 100%;
  height: 160px;
  object-fit: cover;
  display: block;
  filter: contrast(1.05) saturate(0.92) hue-rotate(170deg);
  opacity: 0.85;
}

.fixerCard--angus {
  border-color: rgba(255, 215, 122, 0.28);
  box-shadow: inset 0 0 0 1px rgba(255, 95, 95, 0.10);
}

.fixerCard--angus::before {
  background:
    repeating-linear-gradient(0deg, rgba(255, 255, 255, 0) 0px, rgba(255, 255, 255, 0.03) 2px, rgba(0, 0, 0, 0) 6px),
    radial-gradient(520px 220px at 50% 10%, rgba(255, 215, 122, 0.12), transparent 62%);
}

.fixerCard--angus .fixerCard__img {
  height: 140px;
  filter: contrast(1.08) saturate(1.08);
  opacity: 0.92;
}

@media (max-width: 420px) {
  .fixerCard {
    margin-bottom: 8px;
  }
  .fixerCard__img {
    height: 116px;
  }
  .fixerCard--angus .fixerCard__img {
    height: 104px;
  }
}

.terminalInput {
  width: 100%;
  border-radius: 14px;
  border: 1px solid rgba(103, 211, 255, 0.18);
  background: rgba(7, 18, 26, 0.62);
  color: rgba(232, 251, 255, 0.98);
  padding: 12px 12px;
  font-family: var(--mono);
  letter-spacing: 0.06em;
  text-transform: none;
  font-size: 16px; /* prevent iOS zoom-on-focus */
  min-height: 44px;
}

/* Allow selecting the final code (copy fallback) */
.finalScene__code {
  -webkit-user-select: text;
  user-select: text;
}

@media (max-width: 520px) {
  .terminalPrompt__text {
    font-size: 20px;
  }
}

.terminalInput:focus-visible {
  outline: 2px solid rgba(255, 215, 122, 0.55);
  outline-offset: 2px;
}

.terminalResult {
  margin-top: 10px;
  color: rgba(216, 246, 255, 0.7);
  letter-spacing: 0.16em;
  text-transform: uppercase;
  font-size: 12px;
}

.terminalResult--ok {
  color: rgba(31, 143, 84, 0.92);
}

.terminalError {
  position: absolute;
  inset: 0;
  z-index: 5;
  display: grid;
  place-items: center;
  pointer-events: none;
}

.terminalError__panel {
  padding: 12px 14px;
  border-radius: 999px;
  border: 1px solid rgba(255, 95, 95, 0.55);
  background: rgba(20, 6, 8, 0.78);
  color: rgba(255, 95, 95, 0.95);
  letter-spacing: 0.22em;
  text-transform: uppercase;
  font-size: 12px;
  text-align: center;
  box-shadow:
    0 20px 80px rgba(0, 0, 0, 0.65),
    0 0 0 10px rgba(255, 95, 95, 0.06);
}

.terminalError__sub {
  margin-top: 8px;
  font-family: var(--serif);
  letter-spacing: 0.01em;
  text-transform: none;
  color: rgba(255, 215, 122, 0.92);
  font-size: 14px;
}

.terminalHint {
  position: absolute;
  left: 12px;
  right: 12px;
  top: 64px;
  z-index: 6;
  border-radius: 16px;
  border: 1px solid rgba(255, 215, 122, 0.22);
  background: rgba(7, 18, 26, 0.82);
  backdrop-filter: blur(10px);
  padding: 12px;
  box-shadow: 0 30px 120px rgba(0, 0, 0, 0.72);
  pointer-events: none;
}

.terminalHint__title {
  font-size: 12px;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.78);
}

.terminalHint__text {
  margin-top: 6px;
  font-family: var(--serif);
  font-size: 16px;
  line-height: 1.35;
  color: rgba(232, 251, 255, 0.96);
}

/* “Correct!” confetti burst (small + fast) */
.okConfetti {
  position: absolute;
  inset: -30px -30px -30px -30px;
  z-index: 4;
  pointer-events: none;
  overflow: hidden;
}

.okConfetti__p {
  position: absolute;
  left: 50%;
  top: 45%;
  width: 8px;
  height: 14px;
  border-radius: 2px;
  background: rgba(255, 215, 122, 0.95);
  opacity: 0;
  transform: translate(-50%, -50%);
  animation: okPop 520ms ease forwards;
  animation-delay: calc(var(--i) * 10ms);
}

.okConfetti__p--domino {
  width: 10px;
  height: 16px;
  border-radius: 3px;
  background:
    radial-gradient(circle at 32% 32%, rgba(0, 0, 0, 0.75) 0 1px, transparent 2px),
    radial-gradient(circle at 68% 68%, rgba(0, 0, 0, 0.75) 0 1px, transparent 2px),
    radial-gradient(circle at 68% 32%, rgba(0, 0, 0, 0.75) 0 1px, transparent 2px),
    radial-gradient(circle at 32% 68%, rgba(0, 0, 0, 0.75) 0 1px, transparent 2px),
    linear-gradient(180deg, rgba(255, 255, 255, 0.92), rgba(216, 246, 255, 0.75));
  border: 1px solid rgba(103, 211, 255, 0.35);
  box-shadow: 0 6px 14px rgba(0, 0, 0, 0.28);
}

.okConfetti__p:nth-child(3n) {
  background: rgba(208, 36, 61, 0.95);
}
.okConfetti__p:nth-child(4n) {
  background: rgba(31, 143, 84, 0.95);
}
.okConfetti__p:nth-child(5n) {
  background: rgba(103, 211, 255, 0.95);
}

@keyframes okPop {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.8);
  }
  15% {
    opacity: 1;
  }
  100% {
    opacity: 0;
    transform: translate(calc(-50% + (var(--i) - 9) * 20px), calc(-50% - 220px)) rotate(calc(var(--i) * 24deg));
  }
}

/* Easter egg glitch frame */
.eggGlitch {
  position: absolute;
  inset: -10px -10px auto -10px;
  height: 220px;
  border-radius: 18px;
  overflow: hidden;
  border: 1px solid rgba(103, 211, 255, 0.18);
  background: rgba(0, 0, 0, 0.65);
  box-shadow: 0 30px 110px rgba(0, 0, 0, 0.75);
  mix-blend-mode: screen;
  opacity: 0.9;
  pointer-events: none;
  transform: skewX(-1deg);
}

.eggGlitch__img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  filter:
    grayscale(0.25)
    contrast(1.15)
    saturate(0.9)
    hue-rotate(160deg)
    brightness(0.9);
  opacity: 0.55;
}

.eggGlitch__scan {
  position: absolute;
  inset: 0;
  background: repeating-linear-gradient(
    to bottom,
    rgba(255, 255, 255, 0.06) 0px,
    rgba(255, 255, 255, 0.02) 1px,
    rgba(0, 0, 0, 0) 3px
  );
  background-size: 100% 4px;
  opacity: 0.35;
}

.eggGlitch__noise {
  position: absolute;
  inset: -40px;
  background:
    radial-gradient(2px 2px at 20% 30%, rgba(255, 255, 255, 0.18), transparent 60%),
    radial-gradient(2px 2px at 70% 60%, rgba(255, 255, 255, 0.14), transparent 60%),
    radial-gradient(2px 2px at 40% 80%, rgba(255, 255, 255, 0.12), transparent 60%);
  opacity: 0.22;
  animation: eggJitter 420ms steps(2) infinite;
}

@keyframes eggJitter {
  0% { transform: translate(0px, 0px); }
  50% { transform: translate(2px, -1px); }
  100% { transform: translate(0px, 0px); }
}

.terminalRevealPanel {
  border-radius: 18px;
  border: 1px solid rgba(255, 215, 122, 0.22);
  background:
    radial-gradient(700px 240px at 50% 20%, rgba(255, 215, 122, 0.12), transparent 65%),
    rgba(7, 18, 26, 0.62);
  padding: 12px;
}

.terminalRevealPanel__row {
  display: grid;
  grid-template-columns: 80px 1fr;
  gap: 12px;
  align-items: center;
  padding: 8px 6px;
  border-bottom: 1px solid rgba(103, 211, 255, 0.12);
}

.terminalRevealPanel__row:last-child {
  border-bottom: 0;
}

.terminalRevealPanel__label {
  color: rgba(216, 246, 255, 0.72);
  letter-spacing: 0.18em;
  text-transform: uppercase;
  font-size: 11px;
}

.terminalRevealPanel__value {
  font-family: var(--mono);
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: rgba(255, 235, 170, 0.96);
  word-break: break-word;
}

.whisperLine {
  max-width: 980px;
  margin: 10px auto 0;
  color: rgba(216, 246, 255, 0.7);
  font-size: 12px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  text-align: center;
}

/* Lock UI */
.lock {
  width: min(980px, 100%);
  margin: 0 auto;
}

.lock__hint {
  color: rgba(216, 246, 255, 0.78);
  font-size: 12px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  margin-bottom: 10px;
}

/* Postcard / postmark lock */
.postcard {
  border-radius: 26px;
  border: 1px solid rgba(255, 215, 122, 0.22);
  background:
    radial-gradient(900px 260px at 50% 0%, rgba(255, 215, 122, 0.14), transparent 62%),
    radial-gradient(700px 240px at 18% 22%, rgba(208, 36, 61, 0.12), transparent 62%),
    radial-gradient(700px 240px at 82% 28%, rgba(31, 143, 84, 0.12), transparent 62%),
    rgba(7, 18, 26, 0.8);
  box-shadow: 0 34px 140px rgba(0, 0, 0, 0.75);
  overflow: hidden;
  position: relative;
}

.postcard__paper {
  position: absolute;
  inset: 10px;
  border-radius: 20px;
  background:
    radial-gradient(800px 320px at 40% 20%, rgba(255, 215, 122, 0.08), transparent 65%),
    repeating-linear-gradient(0deg, transparent, transparent 22px, rgba(255, 255, 255, 0.025) 23px, transparent 24px),
    rgba(6, 12, 14, 0.35);
  border: 1px solid rgba(103, 211, 255, 0.12);
  filter: saturate(1.02);
}

.postcard__grid {
  position: relative;
  z-index: 1;
  display: grid;
  grid-template-columns: 1.05fr 0.95fr;
  gap: 12px;
  padding: 16px;
}

.postcard__left,
.postcard__right {
  border-radius: 20px;
  border: 1px solid rgba(103, 211, 255, 0.14);
  background: rgba(7, 18, 26, 0.42);
  padding: 14px;
}

.clueCard {
  border-radius: 18px;
  border: 1px solid rgba(255, 215, 122, 0.22);
  background:
    radial-gradient(520px 180px at 30% 20%, rgba(255, 215, 122, 0.08), transparent 62%),
    rgba(7, 18, 26, 0.48);
  padding: 14px;
  min-height: 260px;
}

.clueCard__title {
  font-family: var(--serif);
  letter-spacing: 0.08em;
  text-transform: uppercase;
  font-size: 12px;
  color: rgba(216, 246, 255, 0.92);
}

.clueCard__sub {
  margin-top: 6px;
  color: rgba(216, 246, 255, 0.72);
  font-size: 12px;
  letter-spacing: 0.06em;
  text-transform: uppercase;
}

.clueRow {
  margin-top: 12px;
  border-radius: 14px;
  border: 1px solid rgba(103, 211, 255, 0.14);
  background: rgba(7, 18, 26, 0.42);
  padding: 10px;
  display: grid;
  gap: 10px;
}

.clueRow__label {
  color: rgba(216, 246, 255, 0.78);
  font-size: 11px;
  letter-spacing: 0.18em;
  text-transform: uppercase;
}

.clueRow__opts {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.clueOpt {
  appearance: none;
  border: 1px solid rgba(103, 211, 255, 0.18);
  background: rgba(7, 18, 26, 0.58);
  color: rgba(216, 246, 255, 0.9);
  padding: 8px 10px;
  border-radius: 999px;
  cursor: pointer;
  font-size: 12px;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  transition: transform 120ms ease, border-color 120ms ease, background 120ms ease, filter 120ms ease;
}

.clueOpt:hover {
  transform: translateY(-1px);
  border-color: rgba(255, 215, 122, 0.4);
  filter: brightness(1.04);
}

.clueOpt:active {
  transform: translateY(0px);
}

.clueOpt--on {
  border-color: rgba(255, 215, 122, 0.6);
  background: rgba(34, 22, 10, 0.28);
}

.clueCard__status {
  margin-top: 12px;
  color: rgba(216, 246, 255, 0.7);
  letter-spacing: 0.18em;
  text-transform: uppercase;
  font-size: 11px;
}

.clueCard__status--ok {
  color: rgba(31, 143, 84, 0.92);
}

.mapCard {
  border-radius: 18px;
  border: 1px solid rgba(103, 211, 255, 0.16);
  background:
    radial-gradient(700px 260px at 40% 30%, rgba(103, 211, 255, 0.1), transparent 62%),
    repeating-linear-gradient(0deg, transparent, transparent 18px, rgba(103, 211, 255, 0.08) 19px, transparent 20px),
    repeating-linear-gradient(90deg, transparent, transparent 18px, rgba(103, 211, 255, 0.08) 19px, transparent 20px),
    rgba(7, 18, 26, 0.48);
  padding: 14px;
  min-height: 260px;
  position: relative;
  overflow: hidden;
}

.mapCard__title {
  font-family: var(--serif);
  letter-spacing: 0.08em;
  text-transform: uppercase;
  font-size: 12px;
  color: rgba(216, 246, 255, 0.9);
}

.mapCard__lines {
  position: absolute;
  inset: 0;
  background:
    radial-gradient(380px 180px at 34% 52%, rgba(31, 143, 84, 0.12), transparent 65%),
    radial-gradient(380px 180px at 62% 40%, rgba(208, 36, 61, 0.12), transparent 65%);
  opacity: 0.8;
}

.mapCard__pin {
  position: absolute;
  width: 12px;
  height: 12px;
  border-radius: 999px;
  border: 1px solid rgba(255, 215, 122, 0.65);
  background: rgba(255, 215, 122, 0.9);
  box-shadow: 0 0 0 6px rgba(255, 215, 122, 0.12);
}

.mapCard__pin--tb {
  left: 32%;
  top: 44%;
}

.mapCard__pin--tor {
  left: 62%;
  top: 66%;
  border-color: rgba(103, 211, 255, 0.6);
  background: rgba(103, 211, 255, 0.85);
  box-shadow: 0 0 0 6px rgba(103, 211, 255, 0.12);
}

.mapCard__pin--estate {
  left: 72%;
  top: 34%;
  border-color: rgba(208, 36, 61, 0.65);
  background: rgba(208, 36, 61, 0.88);
  box-shadow: 0 0 0 6px rgba(208, 36, 61, 0.12);
}

.stamps {
  display: grid;
  gap: 10px;
}

.stamp {
  position: relative;
  text-align: left;
  border-radius: 18px;
  border: 1px solid rgba(255, 215, 122, 0.18);
  background:
    radial-gradient(420px 160px at 20% 20%, rgba(255, 215, 122, 0.1), transparent 60%),
    rgba(7, 18, 26, 0.55);
  padding: 14px;
  cursor: pointer;
  overflow: hidden;
  transition: transform 120ms ease, border-color 120ms ease, filter 120ms ease;
}

.stamp:hover {
  transform: translateY(-1px);
  border-color: rgba(255, 215, 122, 0.42);
  filter: brightness(1.05);
}

.stamp:disabled {
  cursor: default;
  opacity: 0.7;
}

.stamp__frame {
  position: absolute;
  inset: 10px;
  border-radius: 14px;
  border: 1px dashed rgba(216, 246, 255, 0.16);
  pointer-events: none;
}

.stamp__meta {
  position: relative;
  z-index: 2;
}

.stamp__hint {
  color: rgba(216, 246, 255, 0.72);
  font-size: 11px;
  letter-spacing: 0.18em;
  text-transform: uppercase;
}

.stamp__title {
  font-family: var(--serif);
  font-size: 18px;
  margin-top: 6px;
}

.stamp__sub {
  color: rgba(216, 246, 255, 0.8);
  font-size: 12px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  margin-top: 2px;
}

.stamp__facts {
  margin-top: 10px;
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  opacity: 0.9;
}

.stampFact {
  padding: 4px 8px;
  border-radius: 999px;
  border: 1px solid rgba(103, 211, 255, 0.14);
  background: rgba(7, 18, 26, 0.42);
  color: rgba(216, 246, 255, 0.85);
  font-size: 11px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
}

.stamp__ink {
  position: absolute;
  inset: -40px -40px -40px -40px;
  display: grid;
  place-items: center;
  opacity: 0;
  transform: rotate(-8deg) translateY(-6px) scale(0.98);
  transition: opacity 140ms ease, transform 140ms ease;
  pointer-events: none;
}

.stamp__ink--down {
  opacity: 1;
  transform: rotate(-8deg) translateY(0px) scale(1);
}

.stamp__inkText {
  color: rgba(0, 0, 0, 0.0);
  -webkit-text-stroke: 1px rgba(255, 215, 122, 0.7);
  text-stroke: 1px rgba(255, 215, 122, 0.7);
  font-weight: 700;
  letter-spacing: 0.22em;
}

.stamp__inkRing {
  width: 210px;
  height: 210px;
  border-radius: 999px;
  border: 2px solid rgba(255, 215, 122, 0.5);
  box-shadow: 0 0 0 10px rgba(255, 215, 122, 0.06);
}

.stamp--picked {
  border-color: rgba(255, 215, 122, 0.7);
}

.stamp--wrong {
  border-color: rgba(255, 95, 95, 0.65);
  background:
    radial-gradient(420px 160px at 20% 20%, rgba(255, 95, 95, 0.12), transparent 60%),
    rgba(7, 18, 26, 0.55);
}

.stamp--ready {
  box-shadow: 0 0 0 6px rgba(255, 215, 122, 0.06);
}

.stamp--solved {
  border-color: rgba(31, 143, 84, 0.7);
  background:
    radial-gradient(420px 160px at 20% 20%, rgba(31, 143, 84, 0.14), transparent 60%),
    rgba(7, 18, 26, 0.55);
}

.postcard__whisper {
  margin-top: 10px;
  color: rgba(216, 246, 255, 0.62);
  font-size: 12px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

.postcard__stampBtn {
  margin-top: 12px;
  width: 100%;
  justify-content: center;
}

@media (max-width: 980px) {
  .postcard__grid {
    grid-template-columns: 1fr;
  }
}

/* Lock 2: tape deck */
.deck {
  border-radius: 26px;
  border: 1px solid rgba(103, 211, 255, 0.14);
  background:
    radial-gradient(900px 260px at 50% 0%, rgba(103, 211, 255, 0.1), transparent 62%),
    radial-gradient(700px 240px at 18% 22%, rgba(208, 36, 61, 0.1), transparent 62%),
    rgba(7, 18, 26, 0.52);
  overflow: hidden;
}

.deck__face {
  padding: 14px;
  display: grid;
  gap: 12px;
}

.deck__topRow {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 10px;
}

.deck__label {
  padding: 8px 10px;
  border-radius: 999px;
  border: 1px solid rgba(255, 215, 122, 0.18);
  background: rgba(34, 22, 10, 0.22);
  letter-spacing: 0.18em;
  text-transform: uppercase;
  font-size: 12px;
  color: rgba(216, 246, 255, 0.92);
}

.deck__lights {
  display: inline-flex;
  gap: 8px;
  align-items: center;
}

.lamp {
  width: 12px;
  height: 12px;
  border-radius: 999px;
  background: rgba(216, 246, 255, 0.12);
  border: 1px solid rgba(216, 246, 255, 0.16);
  box-shadow: 0 0 0 4px rgba(216, 246, 255, 0.04);
}

.lamp--on {
  background: rgba(31, 143, 84, 0.92);
  border-color: rgba(31, 143, 84, 0.65);
  box-shadow:
    0 0 0 4px rgba(31, 143, 84, 0.12),
    0 0 18px rgba(31, 143, 84, 0.22);
}

.deck__window {
  position: relative;
  border-radius: 18px;
  border: 1px solid rgba(103, 211, 255, 0.14);
  background:
    radial-gradient(700px 240px at 50% 20%, rgba(255, 215, 122, 0.08), transparent 62%),
    rgba(6, 12, 14, 0.35);
  padding: 14px;
  overflow: hidden;
}

.deck__glow {
  position: absolute;
  inset: 0;
  background:
    radial-gradient(420px 200px at 50% 40%, rgba(103, 211, 255, 0.12), transparent 65%),
    radial-gradient(420px 200px at 40% 70%, rgba(208, 36, 61, 0.06), transparent 65%),
    radial-gradient(420px 200px at 60% 70%, rgba(31, 143, 84, 0.06), transparent 65%);
  pointer-events: none;
}

.tape {
  position: relative;
  height: 140px;
  border-radius: 14px;
  border: 1px solid rgba(255, 215, 122, 0.16);
  background:
    radial-gradient(420px 160px at 50% 40%, rgba(255, 215, 122, 0.1), transparent 62%),
    rgba(7, 18, 26, 0.5);
}

.tape__reel {
  position: absolute;
  top: 50%;
  width: 70px;
  height: 70px;
  border-radius: 999px;
  transform: translateY(-50%);
  border: 1px solid rgba(216, 246, 255, 0.16);
  background:
    radial-gradient(circle at 50% 50%, rgba(216, 246, 255, 0.1) 0 28%, transparent 30%),
    rgba(7, 18, 26, 0.42);
}

.tape__reel--left {
  left: 18%;
}

.tape__reel--right {
  right: 18%;
}

.tape__strip {
  position: absolute;
  left: 18%;
  right: 18%;
  top: 50%;
  height: 8px;
  transform: translateY(-50%);
  background: linear-gradient(90deg, rgba(216, 246, 255, 0.12), rgba(216, 246, 255, 0.03));
  border-radius: 999px;
}

.deck__sliders {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 12px;
}

.slider {
  border-radius: 18px;
  border: 1px solid rgba(103, 211, 255, 0.14);
  background: rgba(7, 18, 26, 0.42);
  padding: 12px;
  display: grid;
  gap: 10px;
  justify-items: center;
}

.slider__cap {
  width: 56px;
  height: 6px;
  border-radius: 999px;
  background: rgba(255, 215, 122, 0.25);
}

.slider__input {
  width: 100%;
}

.slider__ticks {
  width: 100%;
  height: 10px;
  background: repeating-linear-gradient(
    90deg,
    rgba(216, 246, 255, 0.12),
    rgba(216, 246, 255, 0.12) 1px,
    transparent 1px,
    transparent 10px
  );
  opacity: 0.55;
  border-radius: 999px;
}

.slider__readout {
  font-size: 12px;
  letter-spacing: 0.14em;
  color: rgba(216, 246, 255, 0.85);
}

.deck__bottomRow {
  display: flex;
  justify-content: space-between;
  gap: 10px;
  align-items: center;
  color: rgba(216, 246, 255, 0.75);
  font-size: 12px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
}

.deck__status--ok {
  color: rgba(255, 215, 122, 0.92);
}

/* Lock 3: ornament */
.ornament {
  border-radius: 26px;
  border: 1px solid rgba(255, 215, 122, 0.22);
  background:
    radial-gradient(900px 280px at 50% 10%, rgba(255, 215, 122, 0.16), transparent 62%),
    radial-gradient(700px 240px at 18% 22%, rgba(208, 36, 61, 0.12), transparent 62%),
    radial-gradient(700px 240px at 82% 28%, rgba(31, 143, 84, 0.12), transparent 62%),
    rgba(7, 18, 26, 0.62);
  padding: 16px;
  position: relative;
  overflow: hidden;
}

.ornament__cap {
  position: absolute;
  top: 0;
  left: 50%;
  width: 120px;
  height: 42px;
  transform: translateX(-50%);
  border-radius: 0 0 18px 18px;
  background: rgba(255, 215, 122, 0.18);
  border: 1px solid rgba(255, 215, 122, 0.2);
  filter: blur(0.2px);
}

.ornament__glass {
  position: absolute;
  inset: 0;
  background:
    radial-gradient(420px 260px at 40% 20%, rgba(255, 255, 255, 0.05), transparent 60%),
    radial-gradient(520px 320px at 60% 70%, rgba(0, 0, 0, 0.25), transparent 60%);
  pointer-events: none;
}

.ornament__dials {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 12px;
  margin-top: 28px;
}

.dial {
  height: 88px;
  border-radius: 22px;
  border: 1px solid rgba(103, 211, 255, 0.16);
  background:
    radial-gradient(260px 120px at 20% 20%, rgba(103, 211, 255, 0.08), transparent 60%),
    rgba(7, 18, 26, 0.5);
  cursor: pointer;
  display: grid;
  place-items: center;
  transition: transform 120ms ease, border-color 120ms ease, filter 120ms ease;
}

.dial:hover {
  transform: translateY(-1px);
  border-color: rgba(255, 215, 122, 0.4);
  filter: brightness(1.05);
}

.dial:disabled {
  cursor: default;
  opacity: 0.75;
}

.dial__value {
  font-family: var(--serif);
  font-size: 44px;
  letter-spacing: 0.1em;
  color: rgba(216, 246, 255, 0.95);
  text-shadow: 0 0 18px rgba(255, 215, 122, 0.08);
}

.dial--solved {
  border-color: rgba(31, 143, 84, 0.65);
}

.ornament__readout {
  margin-top: 12px;
  text-align: center;
  font-size: 12px;
  letter-spacing: 0.22em;
  text-transform: uppercase;
  color: rgba(216, 246, 255, 0.75);
}

.ornament__readout--ok {
  color: rgba(255, 215, 122, 0.92);
}

/* Final vault reveal */
.brassPlate {
  width: min(860px, 100%);
  border-radius: 22px;
  border: 1px solid rgba(255, 215, 122, 0.32);
  background:
    radial-gradient(900px 260px at 50% 20%, rgba(255, 215, 122, 0.22), transparent 65%),
    radial-gradient(700px 240px at 20% 30%, rgba(208, 36, 61, 0.12), transparent 62%),
    radial-gradient(700px 240px at 80% 30%, rgba(31, 143, 84, 0.12), transparent 62%),
    linear-gradient(180deg, rgba(60, 46, 18, 0.28), rgba(7, 18, 26, 0.62));
  box-shadow:
    0 30px 110px rgba(0, 0, 0, 0.75),
    0 0 0 10px rgba(255, 215, 122, 0.06);
  padding: 16px;
}

.brassPlate__label {
  color: rgba(216, 246, 255, 0.75);
  letter-spacing: 0.18em;
  text-transform: uppercase;
  font-size: 12px;
}

.brassPlate__code {
  margin-top: 10px;
  font-family: var(--mono);
  font-size: 28px;
  letter-spacing: 0.22em;
  color: rgba(255, 235, 170, 0.96);
  text-shadow:
    0 0 18px rgba(255, 215, 122, 0.16),
    0 2px 0 rgba(0, 0, 0, 0.28);
  word-break: break-word;
}

.riddle {
  width: min(860px, 100%);
  border-radius: 22px;
  border: 1px solid rgba(103, 211, 255, 0.14);
  background: rgba(7, 18, 26, 0.46);
  padding: 14px;
}

.riddle__prompt {
  color: rgba(216, 246, 255, 0.88);
  line-height: 1.55;
  font-size: 13px;
}

.riddle__row {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 10px;
  align-items: center;
  margin-top: 12px;
}

.riddle__input {
  width: 100%;
  border-radius: 14px;
  border: 1px solid rgba(103, 211, 255, 0.18);
  background: rgba(7, 18, 26, 0.62);
  color: rgba(216, 246, 255, 0.95);
  padding: 12px 12px;
  font-family: var(--mono);
  letter-spacing: 0.12em;
  text-transform: uppercase;
}

.riddle__input:focus-visible {
  outline: 2px solid rgba(255, 215, 122, 0.55);
  outline-offset: 2px;
}

.riddle__result {
  margin-top: 10px;
  color: rgba(216, 246, 255, 0.7);
  letter-spacing: 0.16em;
  text-transform: uppercase;
  font-size: 12px;
}

.riddle__result--ok {
  color: rgba(31, 143, 84, 0.92);
}

.intro__panel {
  width: min(760px, 100%);
  border-radius: 22px;
  border: 1px solid rgba(103, 211, 255, 0.22);
  background:
    linear-gradient(180deg, rgba(7, 18, 26, 0.92), rgba(7, 18, 26, 0.78)),
    repeating-linear-gradient(0deg, transparent, transparent 20px, rgba(103, 211, 255, 0.08) 21px, transparent 22px);
  box-shadow: 0 30px 110px rgba(0, 0, 0, 0.72);
  padding: 18px;
}

.intro__kicker {
  font-size: 12px;
  color: var(--muted);
  letter-spacing: 0.12em;
  text-transform: uppercase;
}

.intro__title {
  font-family: var(--serif);
  font-size: 42px;
  letter-spacing: 0.02em;
  margin-top: 8px;
}

.intro__text {
  margin-top: 10px;
  color: rgba(216, 246, 255, 0.92);
  line-height: 1.65;
  font-size: 14px;
}

.intro__sub {
  color: var(--muted);
}

.intro__boot {
  margin-top: 14px;
  border-radius: 14px;
  border: 1px solid rgba(103, 211, 255, 0.16);
  background: rgba(7, 18, 26, 0.56);
  padding: 12px;
  color: rgba(216, 246, 255, 0.9);
  letter-spacing: 0.08em;
  font-size: 12px;
  display: grid;
  gap: 6px;
}

.intro__btn {
  margin-top: 14px;
  padding: 12px 14px;
  border-color: rgba(255, 215, 122, 0.45);
  background: rgba(34, 22, 10, 0.32);
}

.intro__fine {
  margin-top: 12px;
  color: var(--muted);
  font-size: 12px;
  line-height: 1.5;
}


